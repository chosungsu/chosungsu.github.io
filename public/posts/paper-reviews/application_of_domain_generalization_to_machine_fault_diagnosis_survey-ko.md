---
title: 'Applications of Domain Generalization to
Machine Fault Diagnosis: A Survey'
date: '2025-09-20'
tags: ['fault diagnosis', 'paper review']
---

### Abstract

실제 산업 시나리오에서 작동 조건의 변화, 데이터 잡음의 존재, 그리고 측정 장비의 고장은 인지 데이터 (perceptive data)의 분포에 필연적으로 영향을 미칩니다. 딥러닝 기반 고장 진단 알고리즘은 소스 데이터와 타겟 데이터가 독립적이고 동일하게 분포되어 있다는 가정에 크게 의존하며, 학습된 진단 지식은 분포를 벗어난 데이터 (out-of-distribution data)에 일반화하기 어렵습니다.

도메인 일반화 (DG, Domain Generalization)는 제한된 소스 도메인 데이터만을 사용하여 진단 모델을 훈련함으로써 임의의 타겟 도메인 데이터에 대한 일반화를 달성하는 것을 목표로 합니다. 고장 진단을 위한 DG 연구는 최근 몇 년간 놀라운 진전을 이루었으며 많은 성과가 도출되었습니다.

본 논문에서는 최근 몇 년간의 발전을 요약하기 위해 학습 메커니즘 중심 관점에서 고장 진단을 위한 DG에 대한 최초의 포괄적인 문헌 검토를 제공합니다. 구체적으로, 먼저 기본 원칙과 설계 동기의 유사성을 기반으로 기존 방법들을 종합적으로 검토합니다. 그런 다음, 고장 진단을 위한 DG의 최근 경향도 분석합니다. 마지막으로, 현존하는 문제점과 미래 전망을 제시합니다.

---

### Introduction

고장 진단 기술은 생산 현장과 밀접하게 통합된 공학 과학이며, 생산 공정 자동화 발전의 산물입니다. 첨단 센싱 및 컴퓨팅 기술의 발전과 함께, 자동화 장비의 상태 모니터링은 지능형 관리라는 새로운 시대로 접어들었습니다.

<img src="https://velog.velcdn.com/images/devjo/post/79a138d8-512a-496c-94ab-61e9b8afe158/image.png" alt="Example Image" style="display: block; margin: 0 auto; height:150;" />

산업 장비의 지능형 운영 및 유지보수의 중요한 단계로서, 고장 진단 기술은 신호 분석 방법에서 딥러닝 방법으로, 시뮬레이션 실험 시나리오에서 실제 산업 응용 분야로, 깊이와 폭의 발전 단계에 이미 진입했습니다. 심층 신경망은 측정 장비로 수집된 장비 매개변수를 처리하고, 그 강력한 데이터 분석 및 마이닝 능력의 도움으로 고장 진단 결과를 생성하기 위해 DL 기반 고장 진단 방법에서 광범위하게 사용됩니다. 신호 처리 기반 방법과 비교하여, DL 기반 방법의 우수성은 다양한 데이터를 적응적으로 처리하는 진보된 능력에 있습니다. DL에서의 고급 학습을 통해 정밀한 고장 특징이 생성되며 이는 자동화 장비의 건전성 상태를 더 정확하게 평가할 수 있습니다. 딥러닝 기술을 활용한 자동화 장비의 지능형 운영 및 유지보수 프로세스는 위 그림에 나타나 있습니다.

<img src="https://velog.velcdn.com/images/devjo/post/e1762408-cb0a-4246-a55b-ae860bdaccac/image.png" alt="Example Image" style="display: block; margin: 0 auto; height:150;" />

DL이 자동화 장비의 신속하고 정확한 고장 진단을 달성할 수 있지만, 훈련 (소스 도메인) 데이터와 테스트 (타겟 도메인) 데이터가 독립적이며 동일하게 분포되어 있다는 지나치게 단순화된 가정에 강하게 의존합니다. DL 알고리즘이 소스 도메인 분포를 벗어난 데이터에 직면하면, 도메인 이동 (domain shift)으로 인해 소스 도메인 데이터만으로 훈련된 DL 모델은 상당한 성능 저하를 겪는 경우가 많습니다. 이러한 점을 고려할 때, 소스 도메인 데이터와 타겟 도메인 데이터 간의 도메인 이동 문제를 성공적으로 해결하는 것이 고장 진단 문제에서 최우선 과제입니다. 타겟 도메인 데이터에 제한 없이 접근할 수 있고 직접 사용할 수 있는 경우, 가장 일반적인 해결책은 전이 학습 (TL, Transfer Learning) 방법을 통해 모델이 소스 도메인에서 학습한 고장 지식을 타겟 도메인 데이터로 전이하는 것이며, 이를 도메인 적응 (DA, Domain Adaptation)이라고 합니다.

---

### Methods

DG에 대한 연구는 고장 진단 분야에서 비교적 늦게 주목받았지만, DG 방법론 개발은 매우 빠르게 진행되었습니다. 이론적 연구는 아직 미성숙하며, DG 기술은 여전히 탐색 단계에 있습니다.

$$
\mathcal{D}_{\text{train}} = \{ \mathcal{S}_i | i=1,...,M \}, \\
\mathcal{S}_i = \{(\mathbf{x}_i^{n_s}, y_i^{n_s})\}_{n_s=1}^{N_s}, \\
\mathcal{T}_j = \{(\mathbf{x}_j^{n_t}, y_j^{n_t})\}_{n_t=1}^{N_t}
$$

모델 훈련을 위한 $M$개의 소스 도메인이 있으며, $\mathcal{S}_i$는 샘플 크기가 $N_s$인 $i$번째 소스 도메인 샘플 세트를 나타냅니다. DG의 목적은 $M$개의 소스 도메인으로부터 임의의 미지 도메인으로 일반화될 수 있는 예측 함수 $\mathcal{F} = { \mathcal{Y}, f(\mathbf{x}) }$를 학습하고, 알 수 없는 타겟 도메인 $\mathcal{D}_{\text{test}} = { \mathcal{T}_j | j=1,...,L }$에서 최소 예측 오차를 달성하는 것입니다. $\mathcal{T}_j$는 총 $N_t$개의 샘플을 가진 $j$번째 타겟 도메인을 나타냅니다.

#### 도메인 정렬(적대적 학습)

<img src="https://velog.velcdn.com/images/devjo/post/bb63862d-2afb-458f-8fbd-a99703235eb9/image.png" alt="Example Image" style="display: block; margin: 0 auto; height:150;" />

고장 진단의 방법에서 도메인 정렬(domain alignment) 범주에 속한 적대적 학습(adversarial learning)은 생성적 적대 신경망(gan)을 통해 샘플크기를 확장하여 네트워크가 더 충분히 훈련되고 더 일반화된 특징을 학습하거나 다중 소스 도메인 데이터에 대해 적대적 훈련을 수행하여 도메인 불변 특징을 마이닝하고 도메인 이동한 성능 손실에 강건하도록 합니다.

$$
\min_{G} \max_{D} V(G, D) = \mathbb{E}_{\mathbf{x} \sim P_{\text{data}}} [\ln D(\mathbf{x})] + \mathbb{E}_{\mathbf{z} \sim P_{\mathbf{z}}} [\ln(1 - D(G(\mathbf{z})))]
$$

GAN은 생성기(generator)와 판별기(discriminator)로 구성됩니다. 생성기는 가짜 신호 샘플을 생성하는 데 사용되며 판별기는 입력 샘플이 실제인지 가짜인지를 구별합니다. 생성기와 판별기는 네트워크가 안정된 상태 즉, 내쉬 균형(nash eqilibrium)에 도달할 때까지 서로 경쟁합니다.

gan과 비교하여 domain adversarial은 샘플 생성 과정이 제거되며 타겟 도메인 데이터가 생성된 데이터로 인식됩니다. 따라서 가짜 샘플을 생성하는 데 사용되는 생성기는 소스 도메인과 타겟 도메인에서 추출된 특징을 공유 특징 공간으로 인코딩하는 경향이 있습니다. domain generalization 문제에서는 타겟 도메인 데이터에 접근할 수 없다는 사실 때문에, 전통적인 DA 기반 진단 방법은 사용할 수 없습니다. 소스와 소스 도메인 간의 적대적 학습인 MSDAL에서는 소스 도메인 $S_1$, $S_2$ 샘플이 특징 추출기에 입력되어 고수준 특징을 추출합니다. 이후 일반화를 위해 거리함수를 사용하여 아래와 같이 표현됩니다.

$$
\mathcal{L}_{\text{MMD}} = \frac{1}{\mathcal{C}} \sum_{c=1}^{\mathcal{C}} \left\| \frac{1}{N_c^{\mathcal{S}_1}} \sum_{i=1}^{N_c^{\mathcal{S}_1}} \Phi(\mathbf{F}_{c,i}^{\mathcal{S}_1}) - \frac{1}{N_c^{\mathcal{S}_2}} \sum_{j=1}^{N_c^{\mathcal{S}_2}} \Phi(\mathbf{F}_{c,j}^{\mathcal{S}_2}) \right\|_{\Re}^2
$$

그러나 다중 소스 도메인 데이터의 적대적 학습만으로는 소스 도메인의 분포를 벗어난 고장 특징을 마이닝하기 어려워, 일반화된 고장 특징을 학습하는 네트워크의 능력을 제한합니다.

실제 산업 시나리오에서는 고장 데이터의 수집이 상대적으로 제한적이며, 데이터 양과 데이터 다양성 측면에서 모델의 훈련 요구 사항을 충족하기 어려워 미지 도메인에 대한 모델의 일반화 능력이 저하됩니다. 더욱이, 진단 모델은 소스 도메인 데이터로만 훈련되며, 분포를 벗어난 데이터의 고장 특징을 학습하기 위해 소스 도메인 분포의 한계를 돌파하기 어렵습니다. Li et al.은 시간 늘리기 (time-stretching) 방법을 적용하여 소스 도메인 데이터를 증강하고, 증강된 데이터와 원시 소스 도메인 데이터 간에 적대적 학습을 수행하여 도메인 불변 특징을 학습했습니다. 이 접근 방식의 동기는 다른 고장 특징 주파수를 시뮬레이션하여 훈련 데이터의 구성을 최적화하는 것입니다. Han et al.은 진폭 이동 (amplitude shifting)과 추가적인 가우시안 잡음을 단일 소스 도메인 데이터에 적용하여 작동 조건의 변화로 인한 데이터 분포 변환을 시뮬레이션했습니다.

#### 도메인 정렬(분류기 최적화)

<img src="https://velog.velcdn.com/images/devjo/post/db97cd61-398b-4063-bdaa-f80976fb164c/image.png" alt="Example Image" style="display: block; margin: 0 auto; height:150;" />

분류기는 출력 계층으로서 고장 진단에서 중요한 역할을 합니다. 고장 진단 네트워크는 일반적으로 훈련 샘플에 의해 훈련되어 단일 최적의 개별 분류기를 얻습니다. 그러나 단일 분류기만을 사용하는 것이 결정 수준의 표현 병목 현상에 쉽게 직면하여 고장 진단 네트워크의 과적합으로 이어질 수 있음을 발견했습니다.

분류기 병목 현상을 완화하기 위해 다중 임베딩 또는 분류기를 유기적으로 통합하여 네트워크의 의사 결정 프로세스를 최적화하고 단일 분류기보다 더 나은 일반화 성능을 달성하는 데 초점을 맞추었습니다.

Qian et al.은 잔차 융합 분류기 (residual fusion classifier)를 구성하여 다중 고장 특징을 융합함으로써 분류기의 일반화 성능을 향상시켰습니다. Zhao와 Shen은 유사성 측정 방식을 통해 도메인 특정 구조를 유지하는 다중 작업 분류기를 최종 병합 결정에 선택했습니다.

#### 도메인 정렬(메타 학습)

<img src="https://velog.velcdn.com/images/devjo/post/2aa27927-49b1-48e5-96a1-d3220a78369f/image.png" alt="Example Image" style="display: block; margin: 0 auto; height:150;" />

메타 학습은 실제 시나리오에서 소스 도메인에서 타겟 도메인으로의 일반화 과정을 시뮬레이션하는 것으로 정의될 수 있으며, 모델이 훈련 중에 도메인 불변 특징을 학습하도록 강제합니다. 기본적으로, 이는 모델 훈련 중에 실제 시나리오의 훈련 및 테스트 과정을 시뮬레이션하여, 모델의 인식 성능이 메타 훈련 도메인과 메타 테스트 도메인 모두에서 개선되도록 하는 것을 의미합니다. 궁극적으로 모델은 알 수 없는 타겟 도메인에서 잘 수행됩니다.

Ren et al은 다중 소스 도메인 간의 도메인 이동을 더욱 완화하기 위해 그라디언트 정렬 알고리즘을 메타 학습 프레임워크에 도입했습니다.

#### 도메인 정렬(정규화)

정규화는 기계학습에서 모델의 과적합을 방지하는 방법으로 일반적으로 네트워크 훈련의 손실 함수에 정규화 항을 추가하여 네트워크의 학습 과정을 조정함으로써 달성됩니다.

DG에서 정규화는 모델이 소스 도메인에 특화된 특징을 학습하는 것이 아니라 더 일반적인 특징을 학습하도록 장려하기 때문에, 모델이 미지 도메인에서 더 나은 성능을 달성하도록 도울 수 있습니다. MMD(최대평균 불일치)는 서로 다른 도메인의 특징 분포를 가깝게 강제할 수 있는 널리 퍼진 정규화 기술입니다.

예를 들어 Li et al.은 특징 추출기의 출력인 고수준 데이터 표현에 $L_1$ 정규화를 적용했습니다. 다중 소스 도메인 적대적 훈련에서, 클래스 내 차이 거리는 최소화되고 클래스 간 차이 거리는 최대화되어 진단 네트워크의 일반화를 향상시켰습니다.

정규화의 또 다른 일반적인 용도는 도메인 불변 특징의 네트워크 학습을 용이하게 하기 위해 도메인 특정 특징을 도메인 불변 특징으로부터 식별하고 분리하는 것입니다. 예를 들어, Pang은 학습된 고장 특징을 도메인 특정 특징으로부터 분리하기 위해 힐베르트-슈미트 독립 기준 (HSIC, Hilbert-Schmidt independence criterion) 정규화를 설계했습니다. 이 방법에서는 먼저 다중 소스 도메인과 그에 상응하는 도메인 레이블의 HSIC 항목을 계산한 다음, 이를 최소화함으로써 네트워크가 학습한 특징이 도메인 지식으로부터 가장 큰 독립성을 갖도록 했습니다.

#### 도메인 정렬(인과 학습)

소스 도메인 데이터 간의 상관관계만을 분석하여 도메인 불변 특징을 학습하는 것만으로는 고장 진단 모델이 강력한 논리적 사고 및 판단 능력을 갖도록 만들기 어렵다는 인식이 커지고 있습니다. 미지 도메인과 소스 도메인 사이에 큰 도메인 간격이 발생하면 고장 진단 모델의 일반화 성능이 크게 감소합니다. 예를 들어, Jia et al.은 구조적 인과 모델을 사용하여 시계열 데이터를 인과 요인 (고장 관련 표현)과 비인과 요인 (도메인 관련 표현)으로 분리했으며, 디코더의 재구성 손실을 통해 분리된 요인들의 정보 무결성을 보장했습니다.

#### 도메인 정렬(거리 학습 및 대조 학습)

거리 학습 (Metric learning)은 일반적으로 특징 추출기에 의해 추출된 다중 소스 도메인의 고수준 특징 표현에 적용되어 네트워크가 도메인 불변 특징을 학습하도록 강제합니다. 예를 들어, Ren et al.은 도메인 퍼지 전략을 기반으로 한 적대적 학습 메커니즘과 협력하여 클래스 수준 최적화 관점에서 판별 특징을 추출하기 위해 거리 학습을 특징 추출기에 삽입했습니다.

거리 학습은 주로 이진 또는 삼중항 (triplet) 형태로 이루어지므로, 많은 연구에서 삼중항 손실 (triplet loss)을 최소화하여 네트워크가 판별 표현을 포착하도록 장려하고, 클래스 수준에서 클래스 내 밀집도와 클래스 간 분리 가능성을 향상시켰습니다.

$$
\mathcal{L}_{\text{tri}} = \sum_{i=1}^{N_{tr}} \max(0, d(\mathbf{a}_i, \mathbf{p}_i) - d(\mathbf{a}_i, \mathbf{n}_i) + \gamma)
$$

여기서 $N_{tr}$은 훈련 세트에서 선택된 삼중항의 총 수이며, $\mathbf{a}_i$는 앵커 샘플의 특징 벡터, $\mathbf{p}_i$는 긍정 샘플의 특징 벡터, $\mathbf{n}_i$는 부정 샘플의 특징 벡터입니다. $d(\mathbf{a}_i, \mathbf{p}_i)$는 샘플 $\mathbf{a}_i$와 $\mathbf{p}_i$ 사이의 거리 함수이며, $\gamma$는 긍정 샘플 쌍의 거리와 부정 샘플 쌍의 거리 사이에 최소 차이가 있도록 보장하는 양의 상수입니다.

대조 학습은 일반적으로 진단 네트워크의 입력 샘플에 적용되며, 주로 증강된 샘플이 소스 도메인 샘플과 다르면서도 풍부한 고장 정보를 포함하도록 만드는 것을 목표로 합니다. Wang et al.은 확장 도메인 생성 모듈을 구축하여 소스 도메인 분포와 다른 새로운 도메인을 생성했습니다. 또한, 대조 학습과 적대적 학습을 사용하여 생성 모듈과 고장 진단 모듈을 공동으로 최적화했습니다. 전자는 확장 도메인 샘플이 소스 도메인 샘플과 크게 다르도록 하여 고장 샘플의 스타일을 풍부하게 하는 데 사용되었고, 후자는 확장 도메인 샘플과 다중 소스 도메인 샘플의 데이터 분포를 정렬하여 특징 추출기가 다른 스타일을 가진 더 많은 도메인 불변 특징을 학습할 수 있도록 했습니다.

#### 연합 학습

연합 학습은 최근 몇 년간 제시된 분산형 기계 학습 방법으로, 도메인 간 진단 정확도와 개인 정보 보호의 균형을 맞추는 새로운 방법을 제공할 수 있습니다. 훈련 절차에서 다중 참여자는 로컬 데이터 교환 없이 기계 학습 모델을 공동으로 훈련할 수 있으며, 최종 모델의 성능은 로컬 훈련보다 우수하고 중앙 집중식 훈련의 그것에 가깝습니다.

---

### Conclusion

미지 조건 하의 고장 진단은 최근 몇 년 동안 항상 뜨거운 주제이자 최전선의 공격 목표였습니다. 타겟 도메인 데이터에 대한 접근이 요구되는 Domain Adaptation 연구와 비교할 때, Domain Generalization는 실제 산업 시나리오의 요구에 더 적합합니다.

본 논문은 고장 진단을 위한 DG에 대한 학습 메커니즘 지향적 관점에서 최초로 포괄적인 문헌 검토를 제공하여 최근 몇 년간의 발전을 요약했습니다. 본 논문은 고장 진단을 위한 DG와 관련된 기존 연구 결과를 체계적으로 검토하고, 기존 방법들을 GAN, MSDAL, MSDAL-DataAU, MSDAL-SG, 분류기 최적화, 메타 학습, 정규화, 인과 학습, 거리 학습, 대조 학습, 데이터 증강, 앙상블 학습, FL, 준지도 학습, 그리고 단일 소스 도메인 일반화로 분류했습니다. 각 방법의 기본 원리, 연구 동기, 장점과 단점이 분석되고 요약되었습니다.

---

### 참고 자료

[원본 경로 #1](https://ieeexplore.ieee.org/document/10965929)
