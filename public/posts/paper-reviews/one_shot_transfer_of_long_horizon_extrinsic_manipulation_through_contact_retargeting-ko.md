---
title: 'One-Shot Transfer of Long-Horizon Extrinsic Manipulation Through Contact Retargeting'
date: '2025-05-24'
tags: ['robotics', 'paper review']
---

### Abstract

외부 조작(Extrinsic manipulation)은 환경과의 접촉을 활용하여 조작 목표를 달성하는 것을 의미하며, 평행 그리퍼(parallel jaw gripper)만으로는 불가능한 전략들을 가능하게 합니다.

하지만 로봇, 물체, 그리고 환경 간의 장기적인(long-horizon) 접촉 상호작용의 순서를 조직화하는 것은 장면의 다양성, 넓은 행동 공간, 그리고 어려운 접촉 역학(contact dynamics) 때문에 매우 어렵습니다.

본 논문에서 대부분의 외부 조작이 단기적인(short-horizon) 기본 동작들의 조합이라는 점에 주목했습니다. 그리고 이 기본 동작들 각각은 성공하기 위해 바람직한 접촉 구성(contact configuration)으로부터 시작하는 것에 강하게 의존한다는 것을 확인했습니다.

따라서 견고하고 목표 조건에 맞는 단기 기본 정책들의 단일 라이브러리를 준비하고, 각 기본 동작의 접촉 사양에서 파생되는 상태 제약(state constraints)들을 구성하는 프레임워크를 설계했습니다.

테스트 장면과 기본 동작 순서를 지정하는 단일 데모가 주어지면 테스트 장면에 상태 제약을 적용하고 역기구학(inverse kinematics)을 사용하여 중간 목표 상태(intermediate goal states)를 찾아냅니다. 그 후 이 목표들은 기본 정책들에 의해 추적됩니다.

---

### Introduction

외재적 조작(Extrinsic manipulation)이란 조작을 돕기 위해 환경 접촉을 활용하는 것을 의미하며, 이는 로봇 조작 연구에서 새롭게 떠오르는 분야입니다. 환경과의 접촉을 활용하면 단순한 평행 그리퍼로도 기존에는 불가능했던 복잡한 작업을 수행할 수 있습니다. 예를 들어, 잡을 수 없는 초기 자세에 있는 물체를 밀기, 회전(pivoting), 당기기 등을 포함하는 일련의 전-그립(pregrasp) 동작을 먼저 실행함으로써 집어 올릴 수 있습니다.

외재적 조작을 달성하기 위해서는 로봇, 물체, 그리고 환경 간의 접촉 상호작용을 총체적으로 구성하는 것이 필요합니다. 특히 로봇은 현실 세계에 존재하는 다양한 물체 및 환경 형상에 대처할 수 있어야 합니다. 초기 연구들은 접촉 역학을 명시적으로 모델링하여 제어 합성을 시도했습니다. 그러나 접촉 역학을 모델링하는 데 내재된 어려움 때문에, 이러한 연구들은 알려진 물체와 단순한 형상을 가진 물체를 조작하는 것으로 제한되었습니다.

최근 외재적 조작에 관한 문헌들은 새로운 물체에 대해 일반화할 수 있는 강화 학습(RL) 기반의 외재적 조작 정책을 생성하려고 시도했습니다. 하지만 저희가 아는 한 이들 중 새로운 환경에 대해 성공적으로 일반화한 사례는 아직 없습니다. 더욱이, 가려진 물체 잡기(occluded grasping)와 같은 조작 분야의 많은 응용은 본질적으로 장기적 계획(long-horizon)을 필요로 하며, 다중 접촉 전환을 요구합니다. 장기적 계획을 생성하는 어려움을 극복하기 위해, 문헌의 일부 연구들은 데모를 활용하고자 했습니다. 하지만 접촉이 풍부한 조작을 달성하기 위해서는 단일 작업에 대해 수백 개의 데모가 필요할 수 있습니다.

따라서 저희는 완전한 장기적 외재적 조작 문제 대신, 두 가지 하위 문제를 해결하는 것을 제안합니다. 첫째, 주어진 접촉 구성에 대해 물체 및 환경 변화에도 강인한 프리미티브를 얻는 것과, 둘째, 각 프리미티브를 원하는 접촉 구성으로 초기화하는 것입니다. 또한, 저희는 주어진 조작 목표에 대해 프리미티브의 순서가 일반적으로 고정되어 있음을 관찰했습니다. 예를 들어, "물체를 장애물에 밀어 접촉시킨 후 회전시켜 잡을 수 있는 모서리를 노출시키는 가려진 물체 잡기"는 항상 "밀기-회전-잡기" 순서를 가집니다. 따라서, 접촉 순서를 고정하는 작업 데모를 수집함으로써 조합적으로 복잡한 접촉 순서 계획을 우회할 수 있습니다.

---

### Related works

#### Manipulation using environment contacts

일반적으로 조작되는 물체는 테이블이나 벽과 같은 환경의 평평한 표면을 따라 밀거나 미끄러지게 됩니다. 이러한 움직임을 생성하기 위해, 초기 연구들은 종종 수동으로 설계된 전략이나 물리적 모델을 통해 제어 정책을 합성했습니다. 그러나 접촉이 많은 움직임을 모델링하는 데 내재된 어려움으로 인해, 이러한 연구들은 알려진 물체와 단순한 기하학적 구조를 가진 물체를 조작하는 것으로 제한되었습니다. 반면, 최근의 다른 논문들은 RL (강화 학습)을 사용하여 피드백 정책을 얻습니다. 이는 훨씬 더 강건할 수 있으며, 훈련 중에 전혀 보지 못한 기하학적 구조로 일반화될 수 있습니다.

#### Composing primitives for long-horizon manipulation

분할 정복(Divide-and-conquer)은 장기 조작을 다루는 인기 있는 방법이었습니다. 일반적으로 매개변수화된 행동 MDP (Parameterized Action MDP) 프레임워크를 활용하여 작업을 더 짧은 기본 동작 (primitives)으로 분해합니다. 기본 동작 기반 접근 방식의 주요 과제는 기본 동작의 구성 가능성 (composability)을 보장하는 것입니다.

#### Demonstration for manipulation

로봇 조작을 위한 시연 활용은 최근 몇 년 동안 상당한 주목을 받았습니다. 새로운 시스템들이 시연 수집의 장벽을 낮추고 있음에도 불구하고, 필요한 데이터의 양이 엄청나기 때문에 정책 훈련은 여전히 비용이 많이 듭니다. 각 작업은 $50$개에서 $500$개 이상의 시연을 필요로 합니다.

---

### Methods

<img src="https://velog.velcdn.com/images/devjo/post/fbf96902-6785-4a7a-800e-501d51e43c57/image.png" alt="Example Image" style="display: block; margin: 0 auto; height:150;" />

#### Problem Definition

7자유도 (DoF) 로봇 팔과 1자유도 병렬 그리퍼를 사용하여, 기하학적 구조 $O \in \mathcal{O}$를 가진 물체를 환경 $E \in \mathcal{E}$에서 준정적 외부 조작 (quasi-static extrinsic manipulation)하는 것을 고려합니다. 로봇 시스템은 상태 $q \in \mathcal{Q} \subset \mathbb{R}^8$을 가지며, 물체의 포즈는 $x \in \mathcal{X} \subset SE(3)$입니다. 시스템의 상태를 나타내기 위해 $s_t \triangleq (x_t, q_t) \in \mathcal{S} \triangleq \mathcal{X} \times \mathcal{Q}$라는 약어를 사용합니다. 제어 행동은 $u \in \mathcal{U} \subset \mathbb{R}^8$으로 표기합니다. 시스템은 환경과 물체에 의존하는 이산화된 동역학에 의해 지배됩니다.

$$
s_{t+1} = {}^{E, O}f(s_t, u_t)
$$

따라서 $T+1$ 단계 궤적은 $\{{}^{E, O}s_t\}_{t=0, 1, \dots, T}$로 설명될 수 있습니다.

#### Generalizing Extrinsic Manipulation Demos with Contact Retargeting

<img src="https://velog.velcdn.com/images/devjo/post/643514d2-eef7-4455-8ed9-cc9430f0a887/image.png" alt="Example Image" style="display: block; margin: 0 auto; height:150;" />

본 논문에서 접근 방식은 다음 관찰에 근거합니다.

$\Rightarrow$ 장기 외부 조작은 접촉 전환을 기반으로 하는 기본 동작들의 순서로 분해될 수 있습니다.

$\Rightarrow$ 작은 기본 동작 집합으로 대부분의 외부 조작을 포착하기에 충분합니다.

$\Rightarrow$ 각 기본 동작의 성공은 원하는 $\sigma$를 충족하는 데 크게 의존합니다.

$\Rightarrow$ 가정 2와 3 하에서, $\sigma$를 충족하는 것은 환경에 의존하는 $x$를 선택하는 것만을 수반합니다.

단일 접촉 구성 $\sigma_i$에서 시작하는 단기 외부 조작 작업을 처리하기 위해 목표 조건부 정책 $\pi_{\sigma_i}$를 개발하고자 합니다.

$$
s_{t+1} = {}^{E, O}f(s_t, \pi_{\sigma_i}(s_t; \mathcal{E}, \mathcal{O}, \mathcal{G}_i))
$$

4가지 기본 동작인 밀기 (push), 회전 (pivot), 당기기 (pull), 파지 (grasp)를 관절 임피던스 제어와 작업 공간 제어 (OSC)를 사용하여 제어합니다.

역기구학 문제에서 $\sigma$를 상태 제약으로 구현합니다. 여기서 제약을 충족하는 상태는 ${}^{E, O}\sigma$ 집합의 상태이지만, 실제로는 이 집합이 명시적으로 계산되지는 않습니다. 그리퍼 손가락 끝이 물체의 상단과 대략적으로 접촉합니다. 이는 물체의 경계 상자 중 월드 z 좌표가 가장 높은 4개의 정점을 찾은 다음, 이 4개 점의 기하학적 중심을 찾는 방식으로 구현됩니다. 그리퍼 손가락 끝이 벽-물체 접촉의 반대편에서 물체와 접촉하는데 물체와 손가락 끝 사이의 거리가 0이어야 합니다. 말단 장치가 그리퍼를 닫으면 위에서 아래로 물체를 파지할 수 있도록 배치됩니다.

---

### Conclusion

본 연구에서는 모든 접촉 전환에서 역기구학 (IK)을 사용하여 접촉 제약을 강제함으로써 시연 궤적을 테스트 장면으로 재목표 설정합니다. 이렇게 재목표 설정된 궤적은 각 접촉 구성을 위한 단기 정책들의 순서로 추적됩니다. 4가지 도전적인 장기 외부 조작 작업에 대해 실제 환경 물체에서 전체 $81.7%$의 성공률을 달성했습니다.

향후 방향에는 언어 기반 또는 시뮬레이션 기반 시연을 허용하는 것과 접촉 재목표 설정 공식을 일반화하는 것이 포함될 것입니다.

---

### 참고 자료

[원본 경로 #1](https://arxiv.org/pdf/2404.07468)
