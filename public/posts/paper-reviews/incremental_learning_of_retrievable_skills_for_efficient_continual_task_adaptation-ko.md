---
title: 'Incremental Learning of Retrievable Skills For Efficient Continual Task Adaptation'
date: '2025-09-12'
tags: ['embodied ai', 'paper review']
---

### Abstract

지속적인 모방 학습 (Continual Imitation Learning, CiL)은 다중 작업 정책을 달성하기 위해 여러 단계와 작업에 걸쳐 시연 (demonstrations)으로부터 작업 지식을 추출하고 축적하는 것을 포함합니다.

최근 foundation models의 발전과 함께, 새롭게 시연된 작업을 위해 매개변수 효율적으로 어댑터 (adapters)가 설정되는 어댑터 기반 CiL 접근 방식에 대한 관심이 증가하고 있습니다. 이러한 접근 방식은 특정 작업에 대한 매개변수를 분리하고 파국적 망각 (catastrophic forgetting)을 완화하는 경향이 있지만, 서로 다른 시연 간의 지식 공유를 제한합니다.

이러한 지식 공유의 한계를 해결하기 위해 서로 다른 시연으로부터 공유 가능한 기술 (shareable skills)을 점진적으로 학습하는 어댑터 기반 CiL 프레임워크인 IsCiL을 소개합니다. 이는 특히 비정상적인 CiL환경에서 해당 기술을 사용하여 표본 효율적인 작업 적응을 가능하게 합니다.

IsCiL에서, 시연은 상태 임베딩 공간으로 매핑되며, 여기에서 프로토타입 기반 메모리 (prototype-based memory)를 통해 입력 상태에 따라 적절한 기술이 검색될 수 있습니다. 이러한 검색 가능한 기술은 해당 어댑터에서 점진적으로 학습됩니다. Franka-Kitchen 및 Meta-World의 복잡한 작업을 사용한 CiL 실험은 작업 적응과 표본 효율성 모두에서 IsCiL의 강력한 성능을 입증합니다. 또한 작업 비학습 시나리오를 위한 IsCiL의 간단한 확장도 보여줍니다.

---

### Introduction

홈 로봇과 같은 평생 학습 에이전트 (Lifelong agents)는 과거 경험으로부터 지식을 활용하여 순차적 의사 결정 상황에서 새로운 작업에 지속적으로 적응해야 합니다. 그러나 많은 실제 도메인은 이러한 평생 학습 에이전트에게 상당한 어려움을 제기합니다. 이러한 작업의 복잡성과 끊임없이 변화하는 특성으로 인해 에이전트가 지속적으로 적응하기 어렵고, 지식 유지 및 운영 효율성 유지에 어려움을 겪습니다. 예를 들어, 단일 가정 내에서 작동하는 홈 로봇 에이전트는 주방에서의 요리 보조나 욕실에서의 청소와 같은 다양한 영역에서 특정 작업을 학습하며 지속적으로 적응해야 합니다. 동시에, 에이전트가 이전에 학습한 작업에 대한 숙련도를 유지할 뿐만 아니라 향상시켜 집 전체에서 일관된 효율성을 유지하는 것이 중요합니다.

이러한 평생 학습 에이전트를 위해, 에이전트가 시간이 지남에 따라 전문가 시연 (expert demonstrations)을 활용하여 일련의 작업을 점진적으로 학습하여 다중 작업 정책을 달성하는 지속적인 모방 학습 (Continual Imitation Learning, CiL)이 탐색되어 왔습니다. 그러나 CiL는 종종 다음과 같은 실질적인 문제에 직면합니다.

$\Rightarrow$ 모방에 필요한 포괄적인 전문가 시연과 관련된 높은 비용과 비효율성

$\Rightarrow$ 동적이고 비정상적인 환경에서 빈번하게 변화하는 작업

$\Rightarrow$ 전문가 시연으로부터 학습하는 것과 관련된 개인 정보 보호 문제

#### IsCiL 프레임워크 (The IsCiL Framework)

이러한 문제들을 해결하기 위해, 본 논문에서는 기초 모델 (foundation models)의 최근 발전을 활용하여 기술 학습과 미세 조정을 CiL에 통합하는 데 중점을 둡니다. 기초 모델에서 학습된 다중 어댑터를 기반으로 한 지속적인 작업 적응에 대한 관심이 증가하고 있습니다. 어댑터 기반 학습 접근 방식은 개별 작업에 대한 매개변수 격리를 허용하여 CiL에서 이전에 학습된 지식의 파국적 망각을 완화할 수 있도록 합니다.

우리는 이러한 어댑터의 사용에 동기를 부여받아, 다중 어댑터를 통해 서로 다른 시연으로부터 공유 가능한 기술 (shareable skills)을 점진적으로 학습함으로써 앞서 언급된 CiL의 실질적인 문제를 해결하는 새로운 어댑터 기반 CiL프레임워크인 IsCiL을 개발합니다. IsCiL은 특히 비정상적인 CiL환경에서 이러한 기술을 사용하여 표본 효율적인 작업 적응을 용이하게 합니다.구체적으로, IsCiL 프레임워크에서는 skill retriever와 skill decoder를 포함하는 더 작고 관리하기 쉬운 어댑터와 함께 2단계 계층 구조를 갖춘 프로토타입 기반 기술 점진적 학습 방법이 사용됩니다.

---

### Related Works

<img src="https://velog.velcdn.com/images/devjo/post/92d1f7d7-1b20-4c7d-8d7b-f9469565ed55/image.png" alt="Example Image" style="display: block; margin: 0 auto; height:150;" />

#### 1. 지속적인 모방 학습 (Continual imitation learning)

지속 학습에서 파국적 망각 (catastrophic forgetting) 문제를 해결하기 위해, 수많은 연구가 리허설 기법 (rehearsal techniques)을 사용해 왔습니다. 이 기법들은 과거 경험을 재생하여 이전에 학습한 작업에 대한 성능을 유지하는 것을 포함합니다.

또 다른 접근 방식은 추가적인 모델 매개변수를 활용하여 모델 아키텍처를 점진적으로 확장하는 것입니다. 이러한 방법들은 시간이 지남에 따라 모델의 구조를 조정하여 새로운 작업을 수용합니다.

그러나 리허설 기법은 재생 비율에 따라 망각 정도에 높은 가변성을 보이며, 새로운 지식을 통합하기 위해 종종 상당한 훈련 시간을 요구합니다. 반면에 점진적 모델은 평가 중에 단계 식별 (stage identificatio)이 필요하며, 종종 보지 못한 작업을 간과합니다.

본 연구에서는 사전 훈련된 목표 기반 모델 지식을 활용하여 리허설이나 단계 식별을 요구하지 않고도 효과적인 학습 및 확장을 가능하게 하는 CiL 프레임워크를 제안합니다.

#### 2. 사전 훈련된 모델을 사용한 지속적인 작업 적응 (Continual task adaptation with pre-trained models)

최근 몇몇 연구들은 어댑터와 같은 매개변수 효율적인 튜닝 (Parameter Efficient Tuning, PET) 모듈을 통해 지식을 지속적으로 축적하는 사전 훈련된 모델을 사용합니다. 이러한 방법들은 지속 학습 시스템의 유연성과 확장성을 향상시킵니다. 그러나 이들은 어댑터 선택과 학습된 지식 간의 부정확한 매칭으로 인해 어려움을 겪으며, 이는 훈련 중에 학습된 지식과 평가 중에 사용되는 지식 간의 불일치를 초래하여 전반적인 성능을 저해합니다.

순차적 의사 결정 영역에서는 일부 연구들이 사전 훈련된 모델을 적응시키는 것을 탐색했습니다. 작업의 상태 공간이 완전히 분할되어 있어, 더 통합된 환경에서의 적용 가능성이 제한됩니다.

#### 3. Skill adaptation

강화 학습 연구는 기술 탐색 및 기술 사전 지식을 통해 빠른 적응을 향상시켜 왔으며, 오프라인 데이터셋을 통한 표본 효율성 개선에 중점을 둡니다. 이러한 발전에도 불구하고, 고정된 기술 디코더를 새로운 환경에 적응시키는 것은 여전히 어렵습니다.이러한 한계를 극복하기 위해, 기술 기반 소수-샷 모방 학습 (skill-based few-shot imitation learning) 방법이 개발되었습니다. 그러나 이러한 방법들은 광범위한 과거 데이터를 요구하며 확장성 및 일반화에 어려움을 겪습니다. 지속적인 모방 학습에 사용되는 기술 기반 접근 방식조차도 지식 손실을 완화하기 위해 여전히 리허설 데이터를 필요로 하며, 비학습 (unlearning)을 통한 프라이버시 문제 해결에 어려움을 겪습니다.

---

### Methods

<img src="https://velog.velcdn.com/images/devjo/post/2349c9ea-217b-4953-915c-d38d00447f67/image.png" alt="Example Image" style="display: block; margin: 0 auto; height:150;" />

#### 1. Problem formulation

CiL 시나리오에서, 작업 데이터셋의 데이터 스트림 $\{D_i\}_{i=1}^p$를 고려합니다. 여기서 $D_i$는 해당 작업 $\tau_i$에 대한 전문가 시연 $D_i = \{d_i^1, \dots, d_i^{N_i}\}$를 포함합니다. 복잡한 장기 작업 (long-horizon tasks)을 효과적으로 표현하기 위해, 각 작업 $\tau_i$는 하위 목표 목록 $\tau = \{g_i^1, \dots, g_i^M\}$으로 구성됩니다. 각 작업 데이터셋은 유한 시간 마르코프 결정 과정 ($\mathcal{S}, \mathcal{A}, P, R, \mu_0, H$)에서 샘플링되며, 여기서 $\mathcal{S}$는 상태 공간, $\mathcal{A}$는 행동 공간, $P$는 전이 확률, $R$은 보상 함수, $\mu_0$는 초기 상태 분포, $H$는 환경 시간 범위입니다.

시연 $d = \{(s_t, a_t)\}_{t=1}^H$의 경우, 상태 $s_t \in \mathcal{S}$는 관찰 $o_t$와 하위 목표 $g_t$로 구성된 튜플 $(o_t, g_t)$를 나타냅니다. 본 연구에서는 하위 목표를 언어를 통해 표현하고, 언어 기반 목표 임베딩을 $g_t$에 사용하여 언어 조건부 정책 (language-conditioned policies)을 달성합니다.

이때, IsCiL의 목표는 데이터 스트림의 작업에 대한 성능이 각각의 전문가 정책과 유사할 수 있도록 다중 작업 정책 $\pi^*$를 얻는 것입니다. 이는 다음과 같이 공식화됩니다.

$$
\pi^* = \operatorname*{argmin}_{\pi} \left[ \mathbb{E}_i \left[ \sum_{\tau \in \mathcal{T}_i} \text{KL}(\pi(\cdot \mid s) \parallel \tilde{\pi}_{\tau}(\cdot \mid s)) \right] \right]
$$

여기서 $\tilde{\pi}_{\tau}$는 $\tau$에 대한 전문가 정책을 나타내며, $\mathcal{T}_i$는 단계 $i$에서의 평가 작업 집합을 나타냅니다. 이 맥락에서 평가 작업은 여러 단계에 걸쳐 지속적으로 변동합니다.

#### 2. Overall architecture

복잡한 CiL 시나리오를 효과적으로 처리하기 위해, (i) 프로토타입 기반 기술 점진적 학습과 (ii) 작업별 선택적 적응을 포함하는 IsCiL 프레임워크를 제시합니다.

(i) 프로토타입 기반 기술 점진적 학습은 위 그림과 같이, 기술 검색기 $\pi_R$가 각 하위 목표에 대한 기술을 구성하고, 기술 디코더 $\pi_D$가 상태-기술 쌍을 기반으로 단기 행동을 생성하는 2단계 계층 구조를 사용합니다.

이러한 2단계 정책 계층 구조를 위해, 기술 프로토타입이 전문가 시연에서 관찰된 행동의 순차적 패턴과 관련 환경 상태를 포착하는 기술 프로토타입 기반 접근 방식을 사용합니다. 이 프로토타입은 다단계 데이터 스트림에서 학습된 기술에 대한 참조 역할을 합니다. 이러한 기술 프로토타입을 사용하여 작업별 지침 또는 시연을 일련의 적절한 기술로 효과적으로 변환할 수 있습니다. 이 프로토타입 기반 기술 검색 방법을 통해, 정책은 정책 평가를 위해 작업 간에 공유 가능한 기술을 유연하게 사용하며, 이는 과거 또는 미래에 학습되었을 수 있습니다. 이는 CiL 에이전트가 다양한 작업을 효과적으로 학습하고 변동에 신속하게 적응하는 동시에, 다단계 데이터 스트림으로부터 기술 지식을 점진적으로 축적할 수 있도록 합니다. 나아가, 표본 효율적인 학습을 촉진하고 CiL의 안정성을 향상시키기 위해, base model에서 지속적으로 미세 조정되는 매개변수 효율적인 어댑터를 사용합니다. 각 기술 지식은 전용 어댑터 내에 캡슐화되어 기술 디코더 $\pi_D$에 통합되어 전문가 행동을 추론합니다.

(ii) 작업별 선택적 적응에서는 점진적으로 학습된 기술을 사용하여 특정 작업에 적응하기 위해 정책 계층 구조에서 효율적인 작업 적응 절차를 고안합니다. 이는 CiL 에이전트가 작업 분포의 변화 (예: 비정상적인 환경 조건으로 인한)에 대한 적응을 용이하게 할 뿐만 아니라, 명시적인 사용자 요청 (예: 프라이버시 문제로 인한)에 따른 작업 비학습 (task unlearning)을 지원할 수 있도록 합니다. 예를 들어, 스마트 홈 환경이 집 전체에 새로운 스마트 조명 시스템 설치로 업그레이드된다고 가정해 봅시다. 이 경우, 작업별 선택적 적응을 사용하여 이전 시스템과 관련된 오래된 제어 루틴을 제거함으로써 신속한 적응에 사용할 수 있습니다.

#### 3. Prototype-based skill incremental learning

상태 인코더 및 프로토타입 기반 기술 검색기에서 기술 검색을 용이하게 하기 위해, 함수 $f : (o_t, g_t) \to s_t$를 사용하여 관찰과 목표 쌍 $(o_t, g_t)$를 상태 임베딩 $s_t$로 인코딩합니다. 학습 효율성을 위해 일관된 검색 결과를 보장하도록 $f$를 고정 함수로 구현하여, 입력 분포 변화의 부정적인 영향을 완화합니다.

비정상적인 환경에서 상태 분포의 다중 모드 (multi-modality)를 효과적으로 처리하기 위해, 기술 검색기 $\pi_R$를 사용합니다. 이를 위해, 학습된 기술 프로토타입의 집합인 $\mathcal{X}$ 내의 다각적인 기술 프로토타입 $\chi_z \in \mathcal{X}$을 사용합니다. 이러한 프로토타입은 특정 목표 달성 작업과 관련된 전문가 시연의 순차적 패턴을 포착합니다.

$$
\theta_z = \pi_R(s_t; \mathcal{X}) = h \left[ \operatorname*{argmax}_{\chi_z \in \mathcal{X}} \mathcal{S}(\chi_z, s_t) \right]
$$

어댑터 조건부 기술 디코더는 비정상적으로 변화하는 환경에서도 망각 없이 사전 훈련된 기반 모델의 지식을 효과적으로 사용하기 위해, 기술 디코더는 매개변수를 기반으로 조건화됩니다. 기술 디코더 정책 $\pi_D(\hat{a}_t \mid o_t, g_t; \theta_{\text{pre}}, \theta_z)$는 저랭크 적응 (Low-Rank Adaptation, LoRA)을 사용하여 기술 어댑터 매개변수 $\theta_z$와 사전 훈련된 기반 모델 $\theta_{\text{pre}}$로 작동합니다.

기술 점진적 학습에서 새로운 검색 가능한 기술을 점진적으로 학습하기 위해, 우리는 새로운 기술 $z^*$에 대한 기술 프로토타입 및 어댑터 쌍 $(\chi_{z^*}, \theta_{z^*})$을 업데이트합니다.

#### 4. Task-wise selective adaptation

작업 평가 단계에서 사전 훈련된 모델 $\theta_{\text{pre}}$와 학습된 기술 프로토타입 $\mathcal{X}$가 주어지면, 환경으로부터 주어진 입력 $(o_t, g_t)$에 대해 IsCiL은 다음 평가 프로세스를 수행합니다.

$$
\hat{a}_t \sim \pi_D(\hat{a}_t \mid o_t, g_t; \theta_{\text{pre}}, \theta_z), \text{ where } \theta_z = \pi_R(o_t, g_t; \mathcal{X})
$$

평가 프로세스는 목표 $g_t$를 수정함으로써 환경으로부터의 새로운 작업 및 하위 목표 시퀀스에 적응합니다. 이러한 조정은 학습된 작업을 처리하는 것과 유사한 방식으로 적절한 현재 행동의 추론을 가능하게 합니다. 예를 들어, 특정 사용자의 주방 설정에 맞춘 주방 로봇은 추가 훈련 없이 레시피의 변화에 지속적으로 즉시 적응할 수 있습니다.

작업 비학습에서 점진적으로 학습된 기술에 대한 프라이버시 보호를 보장하기 위해, 우리 아키텍처는 작업별 기술 프로토타입 및 어댑터를 제거함으로써 작업 비학습을 허용합니다.

---

### Conclusion

본 연구에서 지속적인 모방 학습 (CiL)의 주요 과제를 해결하기 위해 IsCiL 프레임워크를 제시했습니다. 이 접근 방식은 어댑터 기반 기술 학습을 통합하며, 다각적인 기술 프로토타입과 어댑터 풀을 활용하여 지속적인 작업 적응을 위한 기술 분포를 효과적으로 포착합니다.

IsCiL은 향상된 표본 효율성과 견고한 작업 적응을 특징으로 하며, 어댑터 기반 CiL 접근 방식과 단계적 시연 전반의 지식 공유 필요성 사이의 격차를 효과적으로 해소합니다.

다른 어댑터 기반 CiL 접근 방식과 마찬가지로, IsCiL은 평가를 위한 추가적인 계산을 필요로 하며, 이는 특히 자원 제약적인 환경에서 오버헤드를 발생시킬 수 있습니다. 또한, IsCiL은 훈련 및 평가를 위해 하위 목표 시퀀스에 의존하므로 복잡성과 자원 요구 사항이 증가합니다. 또 다른 한계는 어댑터 매개변수의 적절한 크기를 결정하는 것인데, 이는 사전 훈련된 기반 모델의 성능과 작업 변화의 정도에 따라 달라지므로 최적의 적응을 어렵게 만듭니다. 또한, 임베딩 함수의 안정성과 프로토타입 크기의 균형을 맞추는 것은 최적의 성능을 달성하기 위해 추가적인 개선이 필요한 영역으로 남아 있습니다.

---

### 참고 자료

[원본 경로 #1](https://proceedings.neurips.cc/paper_files/paper/2024/file/1f0832859514e53a0e4f229fc9b3a4a2-Paper-Conference.pdf)
