---
title: 'Language Conditioned Path Planning'
date: '2024-09-27'
tags: ['embodied ai', 'paper review']
---

### Abstract

접촉 (Contact)은 로봇 조작 (robotic manipulation)의 핵심입니다. 때로는 접촉이 요구되지만 (예: 조작 및 파지), 때로는 유해합니다 (예: 장애물 회피 시). 그러나 전통적인 경로 계획 알고리즘은 오로지 충돌 없는 경로에만 초점을 맞추어, 접촉이 많은 작업에서의 적용 가능성을 제한합니다.

이러한 한계를 해결하기 위해, 우리는 접촉 인식이 경로 계획 문제에 통합된 언어 조건부 경로 계획 (Language-Conditioned Path Planning) 영역을 제안합니다.

이 영역의 첫 번째 단계로서 단일 시점 이미지, 언어 프롬프트, 및 로봇 구성만을 사용하여 충돌 함수 (collision function)를 학습하는 새로운 접근 방식인 언어 조건부 충돌 함수 (LACO, Language-Conditioned Collision Functions)를 제안합니다.

---

### Introduction

<img src="https://velog.velcdn.com/images/devjo/post/62cd564d-1ec0-4438-a042-546cfe27eec9/image.png" alt="Example Image" style="display: block; margin: 0 auto; height:150;" />

Collision checking는 로봇 공학의 경로 계획에서 기본적인 측면이며 초기 및 목표 로봇 구성 사이에 환경과의 충돌을 피하는 경로를 찾는 것을 목표로 합니다.

그러나 전통적인 충돌 없는 경로 계획 접근 방식은 객체를 조작하거나 주변 환경과 상호 작용할 때와 같이 환경과의 접촉이 필요한 시나리오에서는 부족합니다. 이러한 경우, 엄격한 충돌 없는 제약 조건은 비현실적이 되며 로봇이 작업을 효과적으로 수행하는 능력을 억제합니다.

#### 언어 조건부 경로 계획 (LAPP) 영역 제안

접촉 인식을 경로 계획 문제에 통합하는 언어 조건부 경로 계획 (Language-Conditioned Path Planning, LAPP) 영역을 제안합니다. 이 영역에서, 경로 계획은 단순히 충돌을 피하는 것에만 관심을 두는 것이 아니라 환경과의 접촉에 대한 정보에 입각한 결정을 내리는 능력도 통합합니다. 이것은 로봇이 컵을 들고 있는 것이나 문을 여는 것과 같은 제어된 상호 작용을 포함하는 복잡한 조작 작업을 수행할 수 있도록 허용합니다.

위 이미지처럼 로봇이 여러 장애물에 직면하고 환경과 상호 작용해야 하는 일반적인 시나리오를 보여줍니다. 충돌 없는 경로는 컵에 도달하는 데 실패하지만, 언어 조건부 경로는 "장난감과 충돌 가능 (Can collide with toy)"이라는 지침을 사용하여 성공적으로 도달합니다.

---

### Methods

#### 언어 조건부 경로 계획

<img src="https://velog.velcdn.com/images/devjo/post/f85cc607-d686-4c21-a807-a5b519d161ed/image.png" alt="Example Image" style="display: block; margin: 0 auto; height:150;" />

로봇 공학에서, 경로 계획 문제는 초기 구성 $s_0$에서 최종 구성 $s_g$까지 시작하는 로봇 구성 (즉, 경유지)의 연결된, 충돌 없는 경로 $p = (s_0, s_1, \ldots, s_g)$를 찾는 것이며, 경로의 모든 구성이 환경과 충돌이 없도록 합니다.

$$
\forall s_t \in p, C(o_t, s_t) = 0
$$

$o_t$와 $s_t$는 각각 시간 $t$에서의 환경 및 로봇 구성을 나타내며, $C(o, s)$는 로봇 구성 $s$가 환경 $o$와 충돌하면 1을 출력하고, 그렇지 않으면 0을 출력하는 충돌 함수를 나타냅니다.

본 논문에서 경로 계획에서 엄격한 충돌 없는 제약 조건을 완화하여 경로 계획이 특히 언어에 의해 안내되는 세계와의 안전하거나 원하는 접촉을 관리할 수 있도록 언어 조건부 경로 계획 (LAPP) 문제를 제안합니다.

$$
\forall s_t \in p, C(o_t, s_t, l) = 0
$$

여기서 $l$은 허용되거나 원하는 충돌로 간주되어야 할 것을 변조하는 언어 프롬프트입니다.

#### 언어 조건부 충돌 함수

언어 조건부 경로 계획을 위해, 경로 계획 알고리즘은 언어로 설명된 어떤 충돌이 허용되고 어떤 충돌이 피해야 할지를 이해해야 합니다.

구체적으로 LACO는 충돌 함수 $C(o, s, l)$을 학습하며 여기서 $o$는 환경의 단일 시점 이미지 관찰이고, $s$는 쿼리된 로봇 관절 상태이며, $l$은 충돌을 허용하는 객체에 해당하는 언어 지침입니다. $o$는 $s$에 해당할 필요가 없으며 환경 구성만을 나타낸다는 점에 유의하십시오.

데이터셋 $\mathcal{D} = \{(o, s, l, y^l, y)\}$ 상에서 $C(o, s, l)$을 훈련합니다. 여기서 $y$는 로봇 상태 $s$가 장면 $o$에서 어떤 충돌을 가지는지를 나타내며 $y^l$은 언어 지침 $l$ 하에서 원치 않는 접촉이 있는지를 나타냅니다.

대규모 코퍼스에서 사전 훈련된 대규모 비전-언어 모델을 활용하기 위해 백본 네트워크로 CLIP의 비전 및 언어 인코더를 사용합니다. 고정된 사전 훈련된 CLIP ViT 인코더로 $256 \times 256$ 크기의 입력 이미지 $o$를 토큰화하고 고정된 사전 훈련된 CLIP 언어 모델로 언어 프롬프트 $l$을 토큰화합니다.

---

### Conclusion

LACO는 환경 역학을 명시적으로 고려하지 않습니다. 일단 객체가 충돌하면, 밀리거나 넘어지는 것으로 반응할 수 있으며, 잠재적으로 다른 근처 객체의 구성과 위치에 영향을 미칠 수 있습니다. 이는 LAPP가 동적 환경을 처리하는 능력을 제한하며, 객체가 크게 움직일 때 차선책이거나 안전하지 않은 경로 계획으로 이어질 수 있습니다.

언어 조건부 경로 계획 (LAPP) 영역은 접촉이 많은 로봇 조작 작업에서 전통적인 충돌 없는 경로 계획의 한계를 해결합니다. 경로 계획에 접촉 인식을 통합함으로써, LAPP는 로봇이 환경과의 접촉에 대한 정보에 입각한 결정을 내릴 수 있도록 허용하여 복잡한 조작 작업을 효과적으로 수행할 수 있도록 합니다.

---

### 참고 자료

[원본 경로 #1](https://arxiv.org/pdf/2308.16893)
