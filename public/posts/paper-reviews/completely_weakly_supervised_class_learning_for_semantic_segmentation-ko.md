---
title: 'Completely Weakly Supervised Class-Incremental Learning for Semantic Segmentation'
date: '2025-04-30'
tags: ['computer vision', 'paper review']
---

### Abstract

본 연구는 이미지 수준 레이블만을 사용하여 기본 클래스 및 추가적인 새로운 클래스 모두에 대한 분할을 학습하는 완전히 약한 지도 클래스-점진적 학습(completely weakly supervised class-incremental learning)을 다룹니다. 현실 세계의 다양하고 새롭게 등장하는 객체를 처리하는 데 중요하지만, 기존 CISS 방법들은 값비싼 픽셀 수준 주석을 훈련에 필요로 합니다. 이러한 한계를 극복하기 위해 최근에는 부분적으로 약한 지도(partially weakly-supervised) 접근법이 제안되었습니다.

이를 위해, 불확실성을 기반으로 로컬라이저(localizer)와 일련의 파운데이션 모델(foundation models)에서 얻은 가상 레이블(pseudo-labels)을 결합하여 견고한 가상 레이블을 생성하는 방법을 제안합니다. 더욱이 파국적 망각(catastrophic forgetting)을 완화하기 위해, 우리는 이전 클래스와 새로운 클래스 모두를 포함하는 다양한 이미지를 유도적으로 생성하는 예시 기반 데이터 증강(exemplar-guided data augmentation) 방법을 도입합니다.

---

### Introduction

클래스-점진적 의미론적 분할(CISS: Class-Incremental Semantic Segmentation)은 컴퓨터 비전 및 로봇 공학 커뮤니티에서 중요한 연구 주제가 되었습니다. CISS는 새롭게 제공된 데이터를 사용하여 이전에 학습한 카테고리 외에 새로운 클래스의 객체에 대한 분할을 학습할 수 있게 합니다. 이 기능은 객체 조작, 로봇 내비게이션, 산업 자동화 등 다양한 응용 분야에서 유용합니다. 예를 들어, 객체 조작에서는 CISS를 통해 로봇이 초기 훈련 데이터셋에 없는 새로운 객체 카테고리를 인식하고 다루는 방법을 학습할 수 있습니다. 로봇 내비게이션에서는 CISS를 통해 로봇이 새로운 유형의 장애물과 객체에 대해 점진적으로 학습할 수 있으므로, 동적으로 변화하는 환경을 안전하고 효과적으로 탐색할 수 있습니다.

그러나 이러한 방법들은 기본 및 점진적 학습 단계 모두에서 밀집된 픽셀 수준 주석(dense pixel-level annotations)을 필요로 하며, 이는 비용이 많이 들고 시간이 소모됩니다. 특히, 이러한 방법의 경우 새로 캡처된 데이터는 점진적 학습에 사용하기 전에 픽셀 수준으로 주석을 달아야 합니다. 한편, 주석 비용을 줄이기 위해 연구자들은 의미론적 분할을 위한 약한 지도(weakly supervised) 및 준지도(semi-supervised) 학습 방법을 연구했습니다.

<img src="https://velog.velcdn.com/images/devjo/post/fe50a753-3b40-45e1-98a4-bd7a639d0083/image.png" alt="Example Image" style="display: block; margin: 0 auto; height:200;" />

특정 밀집 주석 데이터셋에 대한 의존성을 피하고, 데이터셋 간의 클래스 세분성(class granularity) 및 유형의 차이로 인한 혼동을 완화하기 위함입니다. 예를 들어, '가구'와 같은 광범위한 클래스를 포함하는 밀집 주석 데이터셋에서 네트워크를 훈련할 때, '식탁 의자', '안락의자' 또는 '바 스툴'과 같은 새로운 클래스에 대해 네트워크를 점진적으로 훈련하면 불일치가 발생할 수 있습니다. 이 한계를 해결하기 위해, 더 도전적인 작업인 완전히 약한 지도 클래스-점진적 의미론적 분할(CI-WSSS: completely weakly supervised class-incremental semantic segmentation)을 소개합니다.

---

### Method

#### 1. Problem Formulation

$t=1$에서 의미론적 분할 네트워크 $f^1$은 이미지를 포함하고 각 이미지가 최소한 하나의 기본 클래스 $C^1$를 포함하는 이미지 수준 다중 레이블을 가진 데이터셋 $D^1$을 사용하여 훈련됩니다. 이후 $t=2$에서는 이전 데이터셋은 더 이상 사용할 수 없고 $C^2$를 포함하는 이미지 수준 레이블을 가진 새로운 데이터셋 $D^2$가 제공됩니다. 따라서 $f^1$과 $D^2$를 사용하여 $C^1$, $C^2$ 클래스 모두의 객체를 분할하는 네트워크 $f^2$를 훈련합니다.

#### 2. WSSS Network

<img src="https://velog.velcdn.com/images/devjo/post/f8a6dd01-6f55-446a-9c8e-246980e6d09d/image.png" alt="Example Image" style="display: block; margin: 0 auto; height:200;" />

초기 태스크는 이미지 수준 레이블만을 사용하는 WSSS에 해당합니다. 전형적인 WSSS 네트워크는 위 이미지처럼 인코더 $f_e$, 디코더 $f_d$, 로컬라이저 $f_l$로 구성되며 로컬라이저는 밀집된 가상 레이블을 생성하기 위해 훈련 중에만 사용됩니다.

주어진 이미지 $I$에 대해 인코더는 공유 특징 맵 $F$를 추출하여 더코더와 로컬라이저에 공급하고 각각 클래스 스코어 맵 $M_{cls} \in \mathbb{R}^{|C^1| \times H \times W}$과 가상 레이블 맵 $M_{loc} \in \mathbb{R}^{|C^1| \times H \times W}$를 생성합니다.

파운데이션 모델에서 생성된 가상 레이블 $M_{fdt}$과 로컬라이저의 가상 레이블 $M_{loc}$의 결합 사용을 연구합니다. 구체적으로, 주어진 이미지 I와 이미지 수준 클래스 레이블로 구성된 텍스트 프롬프트에 대해, 오픈셋 탐지기를 적용하여 해당 레이블에 대한 객체의 바운딩 박스를 생성합니다. 그 후, 예측된 바운딩 박스는 프롬프트 기반 이미지 분할 모델에서 프롬프트로 활용되어 밀집된 마스크 $M_{fdt} \in \mathbb{R}^{|C^1| \times H \times W}$를 생성합니다.

각 픽셀에 대한 로컬라이저의 확실성(certainty)을 기반으로 $M_{fdt}$와 $M_{loc}$의 픽셀별 가중치 합을 통해 최종 소프트 가상 레이블 $M_{soft-psd}$가 생성됩니다. 최종 가상 레이블 $M_{soft-psd}$와 엔트로피 $W^{psd}_{h,w}$는 다음과 같이 계산됩니다.

$$
M^{\text {soft-psd}}_{\text {c,h,w}} = W^{\text {psd}}_{\text {h,w}} M^{\text {fdt}}_{\text {c,h,w}} + (1-W^{\text {psd}}_{\text {h,w}}) \sigma(M^{\text {loc}}_{\text {c,h,w}}), \\
W^{\text {psd}}_{\text {h,w}} = - \frac{\sum_{c \in C_t} M^{\text {loc}}_{\text {c,h,w}} log(\bar{M}^{\text {loc}}_{\text {c,h,w}})}{log(|C_t|)}
$$

디코더 출력은 $M_{soft-psd}$ 및 그 수정된 버전과 비교하여 두 개의 픽셀별 교차 엔트로피 손실을 계산합니다. 또한 가상 레이블을 기반으로 인코더의 특징 $F$를 모으거나 분리하기 위해 대조 손실을 사용합니다. 마지막으로 정확한 가상 레이블을 생성하기 위해 로컬라이저 출력을 이미지 수준 레이블과 비교하여 손실을 계산합니다.

---

### Experiments

WILSS의 세 가지 일반적인 설정인 15-5 VOC, 10-10 VOC, COCO-to-VOC에서 실험을 수행합니다. 두 VOC 설정의 경우, 훈련에 10,582개, 검증에 1,449개의 이미지를 포함하는 PASCAL VOC 데이터셋을 사용합니다. 15-5 VOC 설정에서는 처음에 15개의 기본 클래스에 대해 네트워크를 훈련하고, 그 후 나머지 5개의 새로운 클래스에 대해 점진적으로 훈련합니다. 10-10 VOC 설정의 경우, 20개의 클래스를 10개의 기본 클래스와 10개의 새로운 클래스로 나눕니다.

또한, 각 설정에 대해 두 가지 시나리오인 분리(disjoint)와 중첩(overlap)을 고려합니다. 분리 시나리오에서는 $D^t$의 이미지가 최소한 하나의 $C^t$ 클래스에 속하는 객체를 포함해야 하며 $C^t_{acc}$ 클래스의 객체를 포함할 수 있습니다. 여기서 이미지 수준 레이블은 $C^t$ 클래스에 대해서만 제공되고 새로운 클래스에 속하는 객체를 포함해선는 안됩니다. 중첩 시나리오에서는 $D^t$의 이미지가 이미지 수준 레이블을 가진 최소한 하나의 $C^t$ 클래스에 속하는 객체를 포함해야 하며 레이블이 없는 추가 객체를 포함할 수 있습니다.

제안된 방법은 VOC 설정의 기본 클래스에서 더 높은 정확도를 달성했으며, COCO-to-VOC 설정에서는 약간 낮은 성능을 보였습니다. 우리는 이것이 COCO 데이터셋의 이미지가 PASCAL VOC 데이터셋의 이미지보다 더 복잡하여 COCO 이미지에 대한 가상 레이블의 정확도가 낮아지기 때문이라고 생각합니다. 이는 결국 ground-truth 밀집 레이블로 훈련된 모델에 비해 기본 클래스의 정확도가 낮아지는 결과를 초래합니다.

---

### Conclusion

본 논문에서는 완전히 약한 지도 클래스-점진적 의미론적 분할이라는 새로운 과제를 소개했습니다. 이 방법은 오직 이미지 수준 클래스 레이블만을 사용하여 기본 클래스에 대한 의미론적 분할을 학습하고, 이전에 학습한 클래스를 분할하는 능력을 유지하면서 새로운 클래스에 대해 점진적으로 훈련하는 것을 목표로 합니다.

실험 결과는 우리의 완전히 약한 지도 방법이 부분적으로 약한 지도 방법에 비해 뛰어난 성능을 보이거나 경쟁력 있는 정확도를 달성함을 보여줍니다.

한계점으로는, 제안된 방법은 로컬라이저의 가상 레이블이 신뢰할 수 없을 때 파운데이션 모델의 가상 레이블이 더 정확하다고 가정합니다. 이 가정은 우리 실험의 이미지에는 일반적으로 적용되지만, 특정 도메인의 이미지에는 적용되지 않을 수도 있습니다.

---

### 참고 자료

[원본 경로 #1](https://arxiv.org/pdf/2505.10781)
