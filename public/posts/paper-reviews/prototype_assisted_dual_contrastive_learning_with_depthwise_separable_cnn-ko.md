---
title: 'PCDC: prototype-assisted dual-contrastive learning with depthwise separable convolutional neural network for few-shot fault diagnosis of permanent magnet synchronous motors under new operating conditions'
date: '2025-09-16'
tags: ['fault diagnosis', 'paper review']
---

### Abstract

영구 자석 동기 모터 (PMSM, permanent magnet synchronous motor)의 고장 진단은 사용자 안전을 보장하고 사고로 인한 경제적 손실을 최소화하기 위해 산업 분야에서 매우 중요합니다. 그러나 최근의 고장 진단 방법, 특히 딥러닝을 사용하는 방법은 산업 분야에서 확보하기 어려울 수 있는 대규모의 레이블 데이터를 요구합니다.

최근 소수 샷 학습 (Few-shot learning)이 데이터 부족을 완화하고 또는 미지의 고장 진단을 가능하게 하기 위해 회전 기계의 고장 진단에 적용되어 왔습니다. 그러나 여전히 두 가지 주요 장애물이 남아 있습니다. (1) 새로운 작동 조건 하에서 사용하기 위한 모델의 제한된 일반화 능력, (2) 고장 유형을 정밀하게 진단하기 위한 불충분한 판별 특징입니다.

이러한 한계를 해결하기 위해, 본 연구는 새로운 작동 조건 하의 영구 자석 동기 모터를 위한 소수 샷 고장 진단을 위해 Prototype-assisted dual-Contrastive learning with Depthwise separable Convolutional neural network를 제안합니다.

---

### Introduction

영구 자석 동기 모터는 정밀 제어 및 고효율성 덕분에 전기 자동차 및 산업용 로봇과 같은 기계 구동 시스템에 널리 사용되어 왔습니다 (Gangsar & Tiwari, 2020; Jang et al., 2023). $\text{PMSM}$이 다양한 응용 분야에서 사용됨에 따라, 사용자 안전을 보장하고 사고로 인한 경제적 손실을 최소화하기 위해 신뢰할 수 있는 고장 진단이 매우 중요합니다.

#### 기존 딥러닝 방법의 한계

딥러닝 기반 모델이 고장 진단 분야에서 일련의 혁신을 가져왔지만, 이러한 방법에는 여전히 한계가 있습니다.

기존 딥러닝 기반 모델은 높은 일반화 성능과 수렴을 보장하기 위해 대규모의 레이블 데이터를 필요로 합니다 (Ma et al., 2023). 그러나 산업 분야에서는 모터가 일반적으로 정상 상태로 작동하며 (Han et al., 2023; Jian & Ao, 2023), 각 고장 유형에 대해 대규모 데이터에 레이블을 지정하는 것은 비용이 많이 들고 노동 집약적인 작업이기 때문에 충분한 레이블 데이터를 얻기 어렵습니다 (Hu et al., 2020).

소스 도메인과 타겟 도메인이 동일한 고장 유형으로 구성되어 있다고 가정하므로, 이전에 보지 못한 모터 고장을 진단하기 어렵습니다 (Feng, Chen, Xie, et al., 2022; Han & Li, 2022). 새로운 모터가 산업 현장에 설치될 때, 사전 고장 이력의 부족으로 인해 미지의 모터 고장이 발생할 수 있습니다.

#### 전이 학습 (TL) 기반 접근 방식

매개변수 TL은 사전 훈련된 모델을 작은 타겟 도메인 데이터셋을 사용하여 미세 조정하여 개선된 타겟 학습자를 형성하는 방법입니다. 특징 표현 TL 모델은 특징 공간에서 도메인 간의 분포 불일치를 최소화하는 것을 목표로 합니다.

다만 전이 학습은 단점이 몇 가지 있습니다.

TL 기반 모델은 사전 훈련된 모델에서 추출된 특징을 필요로 합니다. 특히 실제 환경과 같이 일부 경우에는 사전 훈련된 모델을 얻을 수 없기 때문에 이는 채택에 큰 장애물입니다 (Ruan et al., 2021). 소스 도메인과 타겟 도메인에서 도메인 불변 특징을 추출하기 위해 추가적인 훈련 과정이 필요하지만, 대부분의 실제 산업 환경에서는 수행하기 어렵습니다 (K. Zhang et al., 2020). 추가 훈련 과정에서 타겟 도메인 간섭으로 인해 발생할 수 있는 부정적 전이 (negative transfer)로 인해 모델의 고장 진단 성능이 감소할 수 있습니다 (Ribani & Marengoni, 2019).

#### 소수 샷 학습 (FSL) 기반 접근 방식

FSL 기반 접근 방식은 메타 학습 (meta-learning)을 사용하여 사전 훈련된 모델이나 추가적인 훈련 없이 작은 데이터셋으로부터 학습할 수 있기 때문에, 소스 및 타겟 도메인 모두에서 레이블 데이터가 부족한 환경에 최근 적용되어 왔습니다 (Wu et al., 2020). 또한 소스 도메인에서 관찰되지 않은 미지의 고장 데이터를 진단할 수 있습니다.

예를 들어 소수 샷 설정에서의 미지의 고장 진단 문제를 위해, S.Zhang.et al. (2021)은 모델 불가지론적 메타 학습 (MAML, Model-Agnostic Meta-Learning) 기반의 소수 샷 고장 진단 방법을 도입하여 미지의 베어링 고장 진단을 위한 향상된 모델 일반화 성능을 보여주었습니다.

이러한 연구들이 중요한 기여를 했음에도 불구하고, 기존의 소수 샷 고장 진단 방법은 타겟 도메인 조건 하에서 (특히 고장 특징이 유사할 때) 충분히 판별적이지 않습니다. 또한, 기존 방법들은 새로운 작동 조건 하에서 불충분한 성능을 보이며 주로 속도 또는 토크 수준의 작은 변화 하에서 평가되므로, 작동 조건의 큰 변화에 잘 일반화할 수 있는 방법의 개발이 필요합니다.

---

### Related Works

<img src="https://velog.velcdn.com/images/devjo/post/960437a3-5bc3-4aad-ac34-485bc56fcc69/image.png" alt="Example Image" style="display: block; margin: 0 auto; height:150;" />

#### 1. 지도 소수 샷 학습 (Supervised FSL)

지도 FSL의 목표는 레이블이 지정된 샘플의 양이 부족한 훈련 데이터셋으로부터 얻은 지식을 사용하여 미지의 작업 (unseen tasks)을 일반화하는 것입니다 (Y. Wang et al., 2020). 전통적인 지도 학습 방법이 각 고장 범주의 특징을 학습하기 위해 대규모 데이터를 요구하는 반면, 지도 FSL 방법은 샘플 쌍의 집합이 동일한 범주에 속하는지 여부만을 학습하면 되므로 소량의 데이터로 학습할 수 있습니다.

#### 2. 거리 기반 메타 학습 알고리즘 (Metric-based meta-learning algorithms)

FSL은 메타 학습 (meta-learning)의 하위 집합이며, 메타 학습은 크게 거리 기반 (metric-based)과 최적화 기반 (optimization-based) 메타 학습 접근 방식으로 나뉩니다. 거리 기반 메타 학습 알고리즘은 그 표현력과 쉬운 최적화 덕분에 FSL 분류 작업에서 자주 사용됩니다 (Y. Wang et al., 2020).

이 모델들은 서포트 셋과 쿼리 셋 간의 유사성을 효과적으로 측정하는 방법을 학습하는 것을 목표로 하며, 그 후 학습된 유사성 (거리) 특징을 기반으로 예측이 달성됩니다. 대표적인 모델로는 프로토타입 네트워크 Snell et al., 샴 네트워크Zhou et al., 관계 네트워크 Sung et al. 접근 방식이 포함됩니다. 이 모델들은 특징 추출기와 거리 임베딩 함수로 구성됩니다. 하지만, 유사성을 계산하는 방법은 서로 다릅니다.

---

### Methods

<img src="https://velog.velcdn.com/images/devjo/post/b83b681a-5288-4b86-9234-be9a36760188/image.png" alt="Example Image" style="display: block; margin: 0 auto; height:150;" />

#### Proposed Framework

PCDC는 OFM (Operation-robust Fault feature extraction Module)과 FDM (Few-shot Diagnosis Module)으로 구성됩니다. OFM은 새로운 작동 조건에 대한 PCDC의 일반화 성능을 향상시키기 위해 지정되었습니다. FDM은 PCDC가 작은 데이터셋에 대해 더 판별적이게 하고 고장 진단 성능을 향상시키기 위해 지정되었습니다.

#### 작동 조건에 강건한 고장 특징 추출 모듈

모터 고장은 일반적으로 모터 고정자 전류 신호에서 AM (진폭 변조)과 FM (주파수 변조)을 유도합니다 (Chen & Feng, 2020). 정상 상태 조건에서 모터 고장 (동적 편심 DE)이 발생하면, 진폭 변조된 고정자 전류 신호 $x_{\text{AM}}(t)$ 또는 위상 변조된 고정자 전류 신호 $x_{\text{PM}}(t)$는 고장 특성 주파수 $f_c$로 표현될 수 있습니다 (Blodt, Chabert, et al., 2006; Blodt, Granjon, et al., 2008).

$$
\begin{aligned}
&x_{\text{AM}}(t) = I [1 + \alpha \cos(2\pi f_r t)] \cos(2\pi f_s t) \\
&x_{\text{PM}}(t) = x_{\text{st}}(t) + x_{\text{rt}}(t) \\
&= I_{\text{st}} \sin(2\pi f_s t) + I_{\text{rt}} \sin(2\pi f_s t + \beta \cos(2\pi f_c t))
\end{aligned}
$$

여기서 $I$는 고정자 전류 기본 성분의 진폭입니다. $x_{\text{st}}(t)$와 $x_{\text{rt}}(t)$는 각각 진폭 $I_{\text{st}}$와 $I_{\text{rt}}$를 갖는 고정자 및 회전자 자기장으로부터의 고정자 전류 성분입니다. $\alpha$와 $\beta$는 고장 정도에 비례하는 변조 지수입니다. $f_s$와 $f_r$은 각각 고정자 공급 주파수와 회전 주파수입니다. 고장 유도 변조 항을 추출하기 위해, 힐베르트 변환 $\mathcal{H}$이 사용되어 단상 고정자 전류 신호 $x(t)$를 해석적 신호 $z(t)$로 변환합니다. 해석적 신호의 이산 형태는 다음과 같습니다.

$$
z[t] = x[t] + j\mathcal{H}\{x[t]\} = a[t]e^{j\phi[t]}
$$

주어진 학습률에 대해 모델이 더 빠르게 수렴하고 새로운 부하 토크 및 회전 속도 조건에 잘 일반화되도록 돕기 위해, $\text{min-max}$ 정규화 기법이 스케일링 방법으로 쌍별 입력 $a[t]$와 $b[t]$에 사용됩니다.

#### 특징 추출을 위한 깊이별 분리 가능 컨볼루션

특징 추출기는 모터 고정자 전류 신호의 $\text{IA}$와 $\text{IF}$에서 고유한 고장 유도 변조 특징을 학습하고, 이 두 고유한 특징을 거리 공간 (metric space)으로 매핑하도록 개발되었습니다. 특징 추출기는 서로 다른 매개변수 $\phi$와 $\theta$를 가진 $\text{IB}$와 $\text{PB}$의 두 블록으로 구성됩니다. $\text{IB}$와 $\text{PB}$는 모두 깊이별 분리 가능 특징 추출기 $h(\mathbf{x})$와 거리 임베딩 함수 $m(\mathbf{x})$를 포함합니다. 깊이별 분리 가능 특징 추출기는 공간 및 채널 방향에서 독립적으로 컨볼루션 연산을 수행하므로, 표준 컨볼루션 연산 결과와 동일한 모양의 특징 맵을 형성하면서 모델 매개변수를 줄일 수 있습니다 (Chollet, 2017; Guo et al., 2019). 따라서 제한된 데이터 조건에서 더 적은 모델 매개변수를 사용하는 것이 유리하기 때문에, 깊이별 분리 가능 특징 추출기가 **$\text{FSL}$ 알고리즘에 적합하다고 추론할 수 있습니다.

#### 소수 샷 진단 모듈

본 연구에서는 프로토타입 지원 이중 대조 학습이 제안되었습니다. 이는 두 가지 별개의 대조 학습 접근 방식의 통합을 통해 구현됩니다.

IB는 인스턴스별 대조 학습을 진행하여 국소 유사성 특징을 학습합니다. PB는 프로토타입-인스턴스 대조 학습을 진행하여 국소 및 전역 유사성 특징을 모두 학습합니다.

먼저, IB에서 학습된 인스턴스 임베딩이 PB로 전이됩니다. 인스턴스별 대조 특징을 포함하는 전이된 인스턴스 임베딩을 사용함으로써, PB는 추가적인 학습 매개변수 없이 국소 유사성 특징을 학습할 수 있으며, 이는 FSL에서 과적합 문제를 완화할 수 있습니다. PB 학습 공간에서 프로토타입 임베딩과 전이된 인스턴스 임베딩 사이의 거리 손실을 최적화하는 동안, PB는 국소 및 전역 유사성 특징을 모두 포함하는 프로토타입-인스턴스 대조 특징을 학습할 수 있으며, 이로 인해 PB는 과적합 문제를 완화하면서 인스턴스 판별 능력을 증가시킬 수 있습니다.

$$
\mathcal{L}_{\text{IB}}^{(+)}(\mathbf{x}_{is}, \mathbf{x}_{iq}^{+}) = \left( \left\| F_{\phi}(\mathbf{x}_{is}) - F_{\phi}(\mathbf{x}_{iq}^{+}) \right\|_2 \right)^2 \\
\mathcal{L}_{\text{IB}}^{(-)}(\mathbf{x}_{is}, \mathbf{x}_{iq}^{-}) = \left( \max \left\{ 0, m - \left\| F_{\phi}(\mathbf{x}_{is}) - F_{\phi}(\mathbf{x}_{iq}^{-}) \right\|_2 \right\} \right)^2
$$

긍정 샘플 쌍의 경우, 샘플 임베딩 간의 유클리드 거리는 임베딩 간의 유사성을 증가시키기 위해 최소화됩니다. 반대로, 부정 샘플 임베딩 간의 유클리드 거리는 $m$의 거리로 분리하기 위해 유사성을 감소시키도록 마진 거리 $m$과 함께 최대화됩니다.

---

### Conclusion

본 논문에서는 모터 고정자 전류 신호를 사용하여 모터의 소수 샷 고장 진단을 위한 새로운 PCDC (Prototype-assisted dual-Contrastive learning with Depthwise separable Convolutional neural network) 접근 방식을 제안했습니다. 제안된 방법을 사용하면, 판별적인 유사성 특징과 다양한 작동 조건에 대한 일반화 능력 덕분에 새로운 작동 조건 하의 미지의 고장 범주를 정밀하게 분류할 수 있습니다.

PCDC의 전반적인 성공에도 불구하고, 다음과 같은 몇 가지 한계가 여전히 남아 있습니다. 구체적으로 (i) 과도 (transient) 작동 조건 및 (ii) 잡음 (noisy) 조건 하에서의 진단입니다.

PCDC는 다양한 정상 상태 (steady-state) 작동 조건에는 잘 적응할 수 있지만, 부하 및/또는 속도가 지속적으로 변하는 과도 작동 조건에는 잘 적응하지 못합니다. 정상 상태 작동 조건에서는 PCDC에 사용된 전처리 방법이 다양한 토크 및 속도 수준을 스케일링하여 모터 전류 신호에 대한 작동 조건의 영향을 제거합니다. 그러나 과도 작동 조건에서는 전처리 방법이 시간에 따른 가속도 변화를 반영할 수 없기 때문에 작동 조건의 영향을 제거할 수 없습니다. 따라서 PCDC는 과도 작동 조건에서 성능이 저하될 수 있습니다.향후 연구에서는 도메인 불변 특징 학습을 FSL 모델에 통합하여 과도 작동 조건의 영향을 줄일 것입니다. 도메인 불변 특징은 과도 작동 조건에서 얻은 데이터셋 간에 공유되는 특징으로 정의될 것입니다. 이 특징은 모델이 과도 작동 조건 하에서도 미지의 고장을 진단할 수 있도록 하는 데 중요한 역할을 합니다.

또한, PCDC$는 대규모 데이터로 훈련된 기존 딥러닝 모델에 비해 잡음에 상대적으로 취약합니다. 잡음 제거 오토인코더 (de-noising autoencoder)를 FSL 모델에 통합하여 잡음에 대한 강건성을 향상시킬 것입니다. 잡음 제거 오토인코더는 가상 잡음 신호를 입력으로, 원래 신호를 출력으로 하여 훈련될 것이며, 이는 FSL 모델이 잡음이 있는 환경에 일반화하는 것을 돕는 것을 목표로 합니다.

---

### 참고 자료

[원본 경로 #1](https://academic.oup.com/jcde/article/11/3/337/7687160)
