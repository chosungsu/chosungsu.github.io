---
title: 'Manipulator Kinematics'
date: '2024-11-27'
tags: ['Robotics', 'Manipulation', 'lecture']
---

### Forward Kinematics

#### Problem Statement

Forward Kinematics is the problem of determining the configuration of the end-effector given the joint variables (angles or displacements) of the robot.

Joint Space ($Q$) is the set of all possible joint variable values of the robot. For a manipulator with $p$ revolute joints and $r$ prismatic joints, $Q = \mathbb{T}^p \times \mathbb{R}^r$. The degree of freedom (DOF) is $p+r$.

The Base Frame ($\text{S}$) is a stationary coordinate frame fixed to the base link (link 0) of the manipulator. The Tool Frame ($\text{T}$) is a coordinate frame attached to the end-effector that moves with the robot.

The forward kinematics map $g_{\text{st}}: Q \rightarrow \text{SE}(3)$ for joint variables $\boldsymbol{\theta} \in Q$ is

$$
g_{\text{st}}(\boldsymbol{\theta}) = g_{\text{sl}_1}(\theta_1) g_{\text{l}_1\text{l}_2}(\theta_2) \cdots g_{\text{l}_{n-1}\text{l}_n}(\theta_n) g_{\text{l}_n\text{t}}
$$

#### The Product of Exponentials Formula

Forward kinematics can be expressed more geometrically by using the fact that the motion of each joint is generated by a twist $\boldsymbol{\xi}_i$ associated with the joint axis.

$$
g_{\text{ab}}(\theta) = e^{\widehat{\xi}\theta} g_{\text{ab}}(0)
$$

Therefore, the product of exponentials formula for an arbitrary open-chain manipulator with $n$ degrees of freedom is

$$
g_{\text{st}}(\theta) = e^{\widehat{\xi}_1\theta_1} e^{\widehat{\xi}_2\theta_2} \cdots e^{\widehat{\xi}_n\theta_n} g_{\text{st}}(0)
$$

$g_{\text{st}}(0)$ is the configuration of the tool frame with respect to the base frame when $\theta = \mathbf{0}$.

#### Parameterization of Manipulators via Twists

To simplify calculations, we can choose to align the base frame and tool frame at the reference configuration ($\theta = \mathbf{0}$). In this case, $g_{\text{st}}(0) = \mathbf{I}$, and the formula simplifies to

$$
g_{\text{st}}(\theta) = e^{\widehat{\xi}_1\theta_1} \cdots e^{\widehat{\xi}_n\theta_n}
$$

Denavit-Hartenberg (D-H) parameters are the de facto standard parameterization in robotics. D-H parameters construct the homogeneous transformation $g_{\text{l}_{i-1}\text{l}_i}$ between adjacent frames using rules that specify the position and orientation of a frame $\text{L}_i$ attached to each link, using only 4 scalar parameters ($\alpha_i, a_i, d_i, \phi_i$) for each joint. Since joint twists have 6 independent parameters, this is because the D-H frames are cleverly chosen so that certain cancellations occur.

---

### Manipulator Workspace

The workspace is the set of all end-effector configurations reachable with a given choice of joint angles. $\mathbf{W} = \{g_{\text{st}}(\boldsymbol{\theta}) : \boldsymbol{\theta} \in Q\} \subset \text{SE}(3)$.

The reachable workspace is the set of all positions ($\mathbb{R}^3$) reachable with a choice of joint angles.

$$
\mathbf{W}_{\text{R}} = \{\mathbf{p}(\theta) : \theta \in Q\} \subset \mathbb{R}^3
$$

It represents the volume of space where the end-effector can reach in any direction. The dexterous workspace is the volume of positions ($\mathbb{R}^3$) where the manipulator can reach with arbitrary orientation ($\mathbf{R} \in \text{SO}(3)$).

$$
\mathbf{W}_{\text{D}} = \{\mathbf{p} \in \mathbb{R}^3 : \forall \mathbf{R} \in \text{SO}(3), \\
\exists \theta \text{ with } g_{\text{st}}(\theta) = (\mathbf{p}, \mathbf{R})\} \subset \mathbb{R}^3
$$

For manipulators with a spherical wrist, when the wrist axes intersect at one point and the tool frame is located at this intersection point, the dexterous workspace equals the reachable workspace.

---

### Inverse Kinematics

The Inverse Kinematics problem is the inverse of the forward kinematics problem: given a desired configuration $g_{\text{d}} \in \text{SE}(3)$ of the tool frame, find the joint angles $\theta \in Q$.

$$
g_{\text{st}}(\boldsymbol{\theta}) = g_{\text{d}}
$$

This problem may have multiple solutions, a unique solution, or no solution.

#### A Planar Example

For a planar 2-link manipulator ($l_1, l_2$), the inverse kinematics problem is to solve for $\theta_1$ and $\theta_2$ given a desired end-effector position $(x, y)$. We sequentially calculate $\theta_2$ and $\theta_1$ using polar coordinates $(r, \phi)$ and the Law of Cosines. If the desired configuration is outside the manipulator's workspace, no solution exists.

#### Paden-Kahan Subproblems

Geometric algorithms have been developed to solve inverse kinematics problems using the Product of Exponentials Formula. This method aims to reduce the entire inverse kinematics problem to standard subproblems with known solutions.

Given a zero-pitch twist $\xi$ of unit magnitude and two points $\mathbf{p}, \mathbf{q} \in \mathbb{R}^3$, find $\theta$ that satisfies

$$
e^{\widehat{\boldsymbol{\xi}}\theta} \mathbf{p} = \mathbf{q}
$$

This is the problem of rotating $\mathbf{p}$ about the axis of $\xi$ to match $\mathbf{q}$. We determine $\theta$ using the $atan2$ function with vectors $\mathbf{u}', \mathbf{v}'$ projected onto a plane perpendicular to the $\xi$ axis.

#### General Solutions

Solving general inverse kinematics problems is an active area of research. Methods that are effective especially when axes do not intersect are being studied.

One approach is based on elimination theory from algebraic geometry. This method is a systematic procedure that sequentially eliminates $n-1$ variables from a system of algebraic equations to obtain a single polynomial in one variable.

Kinematic equations containing trigonometric functions are treated as polynomials in $\cos \theta_i$ and $\sin \theta_i$. We rearrange kinematic equations using D-H parameterization and $\mathbf{Ad}_{g}$. And we separate two columns that are independent of $\theta_6$.

---

### The Manipulator Jacobian

We derive the Manipulator Jacobian, which represents the relationship between the forward kinematics map $g_{\text{st}} : Q \to \text{SE}(3)$ and end-effector velocity, and examine its structure and properties. We also cover the dual relationship between wrenches (forces and torques) applied to the end-effector and joint torques.

Traditionally, when representing forward kinematics with a simple mapping like $g: \mathbb{R}^n \to \mathbb{R}^p$, $\frac{\partial g}{\partial \boldsymbol{\theta}}(\boldsymbol{\theta})$ is used as the Jacobian, but when represented as a matrix-valued function like $\text{SE}(3)$, this is inappropriate and has the problem of depending on local coordinate systems. To avoid this, we define the Jacobian using twists.

#### End-effector Velocity

When the manipulator's joints move along a path $\theta(t)$, the end-effector follows the path $g_{\text{st}}(\theta(t))$. The instantaneous spatial velocity of the end-effector is given by the following twist.

$$
\mathcal{V}_{\text{st}}^s = \dot{g}_{\text{st}}(\theta) g_{\text{st}}^{-1}(\theta)
$$

Applying the chain rule, we see that the end-effector velocity is linearly related to individual joint velocities $\dot{\theta}_i$.

$$
\mathcal{V}_{\text{st}}^s = \sum_{i=1}^{n} \left( \frac{\partial g_{\text{st}}}{\partial \theta_i} g_{\text{st}}^{-1}(\theta) \right) \dot{\theta}_i
$$

Expressed in twist coordinates, the end-effector velocity appears as a linear relationship between the spatial manipulator Jacobian and joint velocity.

$$
\mathcal{V}_{\text{st}}^s = J_{\text{st}}^s(\theta) \dot{\theta}
$$

When the forward kinematics map is expressed as the product of exponentials formula $g_{\text{st}}(\theta) = e^{\widehat{\xi}_1 \theta_1} \cdots e^{\widehat{\xi}_n \theta_n} g_{\text{st}}(0)$, each column $\boldsymbol{\xi}_i'$ of the spatial manipulator Jacobian is derived very explicitly as follows.

$$
\left( \frac{\partial g_{\text{st}}}{\partial \theta_i} g_{\text{st}}^{-1} \right)^\vee = \text{Ad}_{e^{\widehat{\xi}_1 \theta_1} \cdots e^{\widehat{\xi}_{i-1} \theta_{i-1}}} (\xi_i)
$$

Therefore, the spatial manipulator Jacobian is

$$
J_{\text{st}}^s(\boldsymbol{\theta}) = \begin{bmatrix} \boldsymbol{\xi}_1 & \boldsymbol{\xi}_2' & \cdots & \boldsymbol{\xi}_n' \end{bmatrix}
$$

This exactly matches transforming the $i$-th joint twist to the current manipulator configuration and does not depend on $\theta_i, \theta_{i+1}, \ldots$. Thanks to this property, $J_{\text{st}}^s(\theta)$ can be calculated through geometric inspection.

We can also define the body manipulator Jacobian $J_{\text{st}}^b$ that connects the body velocity $\mathcal{V}_{\text{st}}^b$ of the end-effector to joint velocity.

$$
\mathcal{V}_{\text{st}}^b = J_{\text{st}}^b(\theta) \dot{\theta}
$$

The spatial Jacobian and body Jacobian are related by the Adjoint transformation.

$$
J_{\text{st}}^s(\theta) = \text{Ad}_{g_{\text{st}}(\theta)} J_{\text{st}}^b(\theta)
$$

If $J_{\text{st}}$ is invertible, we can calculate the joint velocity needed to achieve a desired end-effector spatial velocity $\mathcal{V}_{\text{st}}^s(t)$ as the following ordinary differential equation.

$$
\dot{\theta}(t) = (J_{\text{st}}^s(\theta))^{-1} \mathcal{V}_{\text{st}}^s(t)
$$

By integrating this, we can move the robot to a desired configuration without inverse kinematics calculations.

#### End-effector Forces

The Jacobian is also used to describe the relationship between a wrench $\mathcal{F}$ applied to the end-effector and joint torques $\tau$. This relationship is derived through conservation of work.

$$
\int \dot{\boldsymbol{\theta}}^T \tau dt = \int \mathcal{V}_{\text{st}}^b \cdot \mathcal{F}^b dt
$$

We obtain the relationship that joint torques $\tau$ for body wrench $\mathcal{F}^b$ satisfy $\tau = (J_{\text{st}}^b)^T \mathcal{F}^b$ and joint torques $\tau$ for spatial wrench $\mathcal{F}^s$ satisfy $\tau = (J_{\text{st}}^s)^T \mathcal{F}^s$.

#### Singularities

A singular configuration is a configuration where the rank of the manipulator Jacobian $J_{\text{st}}(\theta)$ drops.

For a 6-degree-of-freedom manipulator, the Jacobian becomes non-invertible, making it impossible to achieve instantaneous motion in certain directions. Near singularities, extremely large joint velocities may be required to maintain the desired end-effector velocity. Alternatively, since some end-effector wrenches lie in the null space of $J_{\text{st}}^T$, those wrenches can be balanced without joint torques.

However, since most manipulators are designed for tasks requiring all degrees of freedom, singular configurations should be avoided.

---

### Redundant and Parallel Manipulators

#### Redundant Manipulators

A kinematically redundant manipulator is a robot with more degrees of freedom ($n > p$) than are minimally required to perform a given task.

The main advantage is that for a given end-effector configuration, there are infinitely many possible joint configurations. This extra freedom can be used for secondary tasks such as obstacle avoidance, singularity avoidance, or optimizing a specific cost function.

The manipulator Jacobian $J_{\text{st}}^s \in \mathbb{R}^{p \times n}$ has more columns than rows.

$$
J_{\text{st}}^s(\theta) = \begin{bmatrix} \xi_1 & \xi_2' & \cdots & \xi_n' \end{bmatrix}
$$

The inverse kinematics problem for redundant manipulators may have infinitely many solutions, and thus is not well-posed. When the end-effector configuration is fixed to $g_{\text{d}}$, the set of possible robot trajectories that maintain this configuration forms a self-motion manifold. This movement satisfies:

$$
g_{\text{st}}(\theta(t)) = g_{\text{d}} \implies J_{\text{st}}^s(\theta(t)) \dot{\theta} = \mathbf{0}
$$

Hence, the admissible joint velocities $\dot{\theta}$ must lie in the null space of the manipulator Jacobian.

#### Redundancy Resolution

To choose among the infinite possible joint space trajectories that generate a desired task-space velocity $\mathcal{V}_{\text{st}}$, additional criteria are used. Commonly, the minimum joint velocity solution is selected, which can be achieved using the Moore-Penrose generalized inverse $J^\dagger$:

$$
\dot{\theta} = J_{\text{st}}^\dagger (\theta) \mathcal{V}_{\text{st}} \quad \text{where} \quad J^\dagger = J^T (J J^T)^{-1}
$$

In static equilibrium, the relationship between joint torques and the end-effector wrench still holds:

$$
\tau = J_{\text{st}}^T \mathcal{F}
$$

#### Parallel Manipulators

A parallel manipulator, or closed-chain manipulator, is a structure in which two or more serial chains connect the end-effector to the base.

Their advantages include higher stiffness compared to open-chain manipulators. Actuators can also be placed near the base, so there is no need to place motors at the distal links.

The kinematics of a parallel manipulator are described by equating the end-effector positions specified by each chain:

$$
g_{\text{st}} = e^{\widehat{\xi}_{11} \theta_{11}} \cdots e^{\widehat{\xi}_{1n_1} \theta_{1n_1}} g_{\text{st}}(0) = e^{\widehat{\xi}_{21} \theta_{21}} \cdots e^{\widehat{\xi}_{2n_2} \theta_{2n_2}} g_{\text{st}}(0)
$$

Constraints are introduced between the joint variables. Thus, not all joint variables can be specified independently, and the joint space $\mathcal{Q}'$ forms a subset of the Cartesian product $\mathcal{Q}$ of the individual joint spaces.

The number of degrees of freedom $F$ can be obtained using Grueblerâ€™s formula:

$$
F = 6N - \sum_{i=1}^g (6 - f_i) = 6(N - g) + \sum_{i=1}^g f_i
$$

Here, $N$ is the number of links, $g$ is the number of joints, and $f_i$ is the degrees of freedom of the $i$-th joint. For planar motion, the coefficient 6 is replaced by 3.

#### Four-bar Linkage

A four-bar linkage consists of the ground and three rigid links connected by revolute joints, forming a planar mechanism. According to the planar version of Gruebler's formula:

$$
F = 3(N - g) + \sum_{i=1}^g f_i = 3(3 - 4) + 4 = 1
$$

This means the system has one degree of freedom, so the motion of the input link determines the motion of the output link.

#### Stewart Platform

The Stewart platform is a parallel mechanism in which two rigid bodies are connected by a set of prismatic joints, each attached via spherical joints. Only the prismatic joints are actuated.

Given a desired platform configuration, the length of each leg can be easily determined by calculating the distance between the base and tool pivots:

$$
\theta_i = \| \mathbf{q}_{\text{s}i} - g_{\text{st}} \mathbf{q}_{\text{t}i} \|
$$

---

### References

[Original source #1](https://www.cse.lehigh.edu/~trink/Courses/RoboticsII/reading/murray-li-sastry-94-complete.pdf)
