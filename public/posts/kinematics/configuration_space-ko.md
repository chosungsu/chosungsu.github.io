---
title: 'Configuration Space'
date: '2024-02-02'
tags: ['Robotics', 'Kinematics', 'lecture']
---

### Degrees of Freedom and Configuration Space of a Robot

로봇은 링크(links)라고 불리는 일련의 물체들을 다양한 유형의 조인트(joints)를 사용하여 서로 연결하여 기계적으로 구성됩니다. 전기 모터와 같은 액추에이터(Actuators)는 로봇의 링크를 움직이게 하는 힘이나 토크를 전달합니다. 일반적으로 물체를 잡고 조작하기 위한 그리퍼나 손과 같은 엔드 이펙터(end-effector)가 특정 링크에 부착됩니다.

로봇에 대해 물어볼 수 있는 가장 근본적인 질문은 "로봇이 어디에 있습니까?"일 것입니다. 답은 로봇의 설정(configuration), 즉 로봇의 모든 지점의 위치에 대한 사양으로 주어집니다. 로봇의 링크는 강체이고 모양이 알려져 있기 때문에 그 설정을 나타내는 데는 소수의 숫자만 필요합니다. 예를 들어 문의 설정은 경첩 주위의 각도 $\theta$라는 단일 숫자로 나타낼 수 있습니다. 평면상의 점의 설정은 두 좌표 $(x, y)$로 설명될 수 있습니다. 평평한 테이블 위에 앞면이 위로 향하게 놓인 동전의 설정은 세 좌표로 설명될 수 있습니다. 동전 위의 특정 지점의 위치를 지정하는 두 좌표 $(x, y)$와 동전의 자세(orientation)를 지정하는 한 좌표 $(\theta)$입니다.

위의 모든 좌표는 연속적인 실수 범위에 걸쳐 값을 취합니다. 로봇의 자유도($\text{dof}$, degrees of freedom)는 그 설정을 나타내는 데 필요한 최소한의 실수 값 좌표의 수입니다. 테이블 위에 앞면이 위로 향하게 놓인 동전은 3자유도를 가집니다. 동전이 앞면 또는 뒷면이 위로 향할 수 있더라도 그 설정 공간은 여전히 3자유도만 가질 것입니다. 동전의 어느 면이 위로 향하는지를 나타내는 네 번째 변수는 다른 세 좌표와 달리 연속적인 실수 범위가 아닌 이산 집합 $\{\text{heads, tails}\}$에서 값을 취하기 때문입니다.

로봇의 설정(configuration)은 로봇의 모든 지점의 위치에 대한 완전한 사양입니다. 설정을 나타내는 데 필요한 최소한의 실수 값 좌표 $n$은 로봇의 자유도($\text{dof}$)입니다. 로봇의 가능한 모든 설정을 포함하는 $n$차원 공간을 설정 공간($\text{C-space}$, Configuration space)이라고 합니다. 로봇의 설정은 $\text{C-space}$의 한 점으로 나타냅니다.

로봇은 강체 링크로 구성되어 있으므로 먼저 단일 강체의 자유도를 검토한 다음 일반적인 다중 링크 로봇의 자유도를 검토합니다. 다음으로 $\text{C-space}$의 모양 (또는 위상)과 기하학, 그리고 그것들의 수학적 표현을 연구합니다.

---

### Degrees of Freedom of a Rigid Body

테이블 위에 놓인 동전의 예로 다시 돌아가서 동전 위의 세 점 $A, B$ 및 $C$를 선택합니다. 좌표 프레임 $\hat{x}–\hat{y}$가 평면에 부착되면 평면에서 이 점들의 위치는 $(x_A, y_A), (x_B, y_B)$ 및 $(x_C, y_C)$로 작성됩니다. 만약 이 점들이 평면상의 어느 곳에나 독립적으로 놓일 수 있다면 동전은 세 점 각각에 대해 두 자유도씩 6자유도를 가질 것입니다. 그러나 강체의 정의에 따라 점 $A$와 점 $B$ 사이의 거리 $d(A, B)$는 동전이 어디에 있든 항상 일정합니다. 마찬가지로 거리 $d(B, C)$와 $d(A, C)$도 일정해야 합니다. 따라서 좌표 $(x_A, y_A), (x_B, y_B),$ 및 $(x_C, y_C)$에 대한 다음의 등식 제약 조건(equality constraints)이 항상 충족되어야 합니다.

$$
\begin{aligned} 
d(A, B) &= \sqrt{(x_A - x_B)^2 + (y_A - y_B)^2} = d_{AB}, \\ d(B, C) &= \sqrt{(x_B - x_C)^2 + (y_B - y_C)^2} = d_{BC}, \\ d(A, C) &= \sqrt{(x_A - x_C)^2 + (y_A - y_C)^2} = d_{AC}
\end{aligned}
$$

테이블 위에 놓인 동전의 자유도를 결정하기 위해 먼저 평면에서 점 $A$의 위치를 선택합니다. $(x_A, y_A)$를 지정하는 두 자유도를 가집니다. $(x_A, y_A)$가 지정되면 제약 조건 $d(A, B) = d_{AB}$는 $(x_B, y_B)$의 선택을 $A$를 중심으로 하고 반지름이 $d_{AB}$인 원 위의 점들로 제한합니다. 이 원 위의 한 점은 단일 매개변수 예를 들어 $A$를 중심으로 하는 원 위에서 $B$의 위치를 지정하는 각도 $\phi_{AB}$로 지정될 수 있습니다. 점 $B$의 위치를 선택하면, $C$에 대해 가능한 위치는 두 개뿐입니다. $A$를 중심으로 하고 반지름이 $d_{AC}$인 원과 $B$를 중심으로 하고 반지름이 $d_{BC}$인 원의 교차점에 있습니다. 이 두 해는 앞면 또는 뒷면에 해당합니다. 요컨대 $A$와 $B$를 배치하고 앞면 또는 뒷면을 선택하면 두 제약 조건 $d(A, C) = d_{AC}$와 $d(B, C) = d_{BC}$는 $(x_C, y_C)$에 의해 제공되는 겉보기 자유도 두 개를 제거하고 $C$의 위치는 고정됩니다. 동전은 평면에서 정확히 3자유도를 가지며 $(x_A, y_A, \phi_{AB})$로 지정될 수 있습니다.

---

### Degrees of Freedom of a Robot

문은 단일 강체로 구성되어 있으며 경첩 조인트(hinge joint)로 벽에 연결되어 있습니다. 경첩 조인트가 없다면 문은 3차원 공간에서 자유롭게 움직일 수 있었을 것이고 6자유도를 가졌을 것입니다. 경첩 조인트를 통해 문을 벽에 연결함으로써 문 운동에 다섯 개의 독립적인 제약 조건이 부과되어 단 하나의 독립적인 좌표($\theta$)만 남습니다.

두 경우 모두 조인트(joints)는 강체의 운동을 구속하여 전체 자유도를 줄입니다. 이 관찰은 로봇의 자유도를 결정하기 위한 공식 즉 강체의 수와 조인트의 수를 세는 것으로 결정할 수 있는 공식을 제시합니다.

#### Robot Joints

모든 조인트는 정확히 두 개의 링크를 연결합니다. 회전 조인트($\text{R}$, Revolute joint) 또는 경첩 조인트는 조인트 축을 중심으로 회전 운동을 허용합니다. 프리즘 조인트($\text{P}$, Prismatic joint) 또는 슬라이딩/선형 조인트는 조인트 축 방향을 따라 병진 운동을 허용합니다. 나선 조인트($\text{H}$, Helical joint) 또는 스크류 조인트는 스크류 축을 중심으로 동시 회전 및 병진을 허용합니다.

회전, 프리즘, 나선 조인트는 모두 1자유도를 가집니다. 조인트는 또한 다중 자유도를 가질 수 있습니다. 원통형 조인트($\text{C}$, Cylindrical joint)는 2자유도를 가지며 단일 고정 조인트 축을 중심으로 독립적인 병진 및 회전을 허용합니다. 유니버설 조인트($\text{U}$, Universal joint)는 또 다른 2자유도 조인트로 조인트 축이 직교하도록 배열된 한 쌍의 회전 조인트로 구성됩니다. 구형 조인트($\text{S}$, Spherical joint) 또는 볼-앤-소켓 조인트는 3자유도를 가지며 사람의 어깨 관절과 매우 유사하게 기능합니다.

조인트는 하나의 강체가 다른 강체에 대해 움직일 수 있도록 자유도를 제공하는 것으로 간주될 수 있습니다. 또한 조인트는 그것이 연결하는 두 강체의 가능한 운동에 대한 제약 조건을 제공하는 것으로도 간주될 수 있습니다. 예를 들어 회전 조인트는 공간에서 두 강체 사이에 하나의 자유 운동을 허용하는 것으로 간주될 수 있으며 또는 한 강체의 다른 강체에 대한 운동에 다섯 개의 제약 조건을 제공하는 것으로 간주될 수 있습니다. 이를 일반화하면 강체의 자유도 (평면 강체의 경우 3, 공간 강체의 경우 6)에서 조인트가 제공하는 제약 조건의 수를 뺀 값은 그 조인트가 제공하는 자유도의 수와 같아야 합니다.

#### Grubler’s Formula

링크와 조인트를 가진 메커니즘의 자유도는 그루블러 공식(Grubler's formula)을 사용하여 계산될 수 있습니다. 지면(ground)도 링크로 간주되는 $N$개의 링크로 구성된 메커니즘을 고려합니다. $J$를 조인트의 수, $m$을 강체의 자유도 (평면 메커니즘의 경우 $m=3$, 공간 메커니즘의 경우 $m=6$), $f_i$를 조인트 $i$가 제공하는 자유도의 수, $c_i$를 조인트 $i$가 제공하는 제약 조건의 수라고 하고 모든 $i$에 대해 $f_i + c_i = m$이라고 합니다. 이 경우 로봇의 자유도에 대한 그루블러 공식은 다음과 같습니다.

$$
\begin{aligned} \text{dof} &= \underbrace{m(N - 1)}_{\text{강체 자유도}} - \underbrace{\sum_{i=1}^{J} c_i}_{\text{조인트 제약 조건}} \\ &= m(N - 1) - \sum_{i=1}^{J} (m - f_i) \\ &= m(N - 1 - J) + \sum_{i=1}^{J} f_i. \end{aligned}
$$

이 공식은 모든 조인트 제약 조건이 독립적인 경우에만 성립합니다. 독립적이지 않은 경우 공식은 자유도의 하한을 제공합니다. 개방형 사슬 메커니즘(open-chain mechanisms) (또는 직렬 메커니즘)과 폐쇄형 사슬 메커니즘(closed-chain mechanisms)을 구별하는 방법으로는 폐쇄형 사슬 메커니즘은 닫힌 루프를 가지는 모든 메커니즘이며 (예: 두 발로 서 있는 사람) 개방형 사슬 메커니즘은 닫힌 루프가 없는 모든 메커니즘입니다 (예: 손이 공간에서 자유롭게 움직일 수 있는 팔).

---

### Configuration Space

#### Topology

<img src="https://velog.velcdn.com/images/devjo/post/1889943e-0343-4a01-867b-45ac58e11f29/image.png" alt="Example Image" style="display: block; margin: 0 auto; height:50;" />

지금까지는 차원 또는 자유도의 수에 초점을 맞췄습니다. 그러나 공간의 모양(shape) 또한 중요합니다. 구의 표면 위를 움직이는 점을 생각해 봅시다. 점의 $\text{C-space}$는 2차원이며, 설정은 위도와 경도라는 두 좌표로 설명될 수 있습니다. 또 다른 예로, 평면 위를 움직이는 점도 좌표 $(x, y)$를 가진 2차원 $\text{C-space}$를 가집니다. 평면과 구의 표면 모두 2차원이지만, 분명히 그것들은 같은 모양을 가지지 않습니다. 평면은 무한히 뻗어 있는 반면 구는 둘러싸여 있습니다.

위상적으로 구별되는 1차원 공간에는 원(circle), 선(line), 그리고 선의 닫힌 구간(closed interval)이 포함됩니다. 원은 수학적으로 $S$ 또는 $S^1$로 작성되며 1차원 구입니다. 선은 $E$ 또는 $E^1$로 작성되며 1차원 유클리드 공간을 나타냅니다. 일부 $\text{C-space}$는 더 낮은 차원의 두 개 이상의 공간의 카르테시안 곱(Cartesian product)으로 표현될 수 있습니다. 예를 들어 평면에서 강체의 $\text{C-space}$는 $R^2 \times S^1$로 작성될 수 있습니다. 설정이 $R^2$를 나타내는 좌표 $(x, y)$와 $S^1$을 나타내는 각도 $\theta$의 연결로 표현될 수 있기 때문입니다.

#### Representation

유클리드 공간에서 점을 나타내기 위해 참조 프레임과 길이 축척을 선택하고 벡터를 사용하는 것이 자연스러운 반면, 구와 같은 곡선 공간 위의 점을 나타내는 것은 덜 명확합니다. 구에 대한 한 가지 해결책은 위도와 경도 좌표를 사용하는 것입니다. $n$차원 공간을 나타내기 위해 $n$개의 좌표 또는 매개변수를 선택하는 것을 공간의 명시적 매개변수화(explicit parametrization)라고 합니다.

표현의 특이점은 좌표의 시간 변화율로서 속도를 나타낼 때 특히 문제가 됩니다. 구 위의 점이 일정한 속도로 움직이고 있더라도 이러한 표현은 특이점 근처에서 무한대로 향할 수 있기 때문입니다.

#### Configuration and Velocity Constraints

<img src="https://velog.velcdn.com/images/devjo/post/13ba9cdf-718c-4e62-ae7d-ae378fa267ef/image.png" alt="Example Image" style="display: block; margin: 0 auto; height:150;" />

하나 이상의 닫힌 루프를 포함하는 로봇의 경우 일반적으로 암시적 표현이 명시적 매개변수화보다 더 쉽게 얻어집니다. 예를 들어 1자유도를 가진 평면 4절 링크에서 항상 닫힌 루프를 형성한다는 사실은 루프 폐쇄 방정식(loop-closure equations)이라고 불리는 세 개의 방정식으로 표현될 수 있습니다.

$$
\begin{aligned}
&L_1cos \theta_1 + L_2cos(\theta_1+\theta_2) + \cdots+ L_4 cos(\theta_1 + \cdots + \theta_4) = 0, \\
&L_1sin \theta_1 + L_2sin(\theta_1+\theta_2) + \cdots+ L_4 sin(\theta_1 + \cdots + \theta_4) = 0, \\
&\theta_1+\theta_2 + \theta_3 + \theta_4-2\pi=0
\end{aligned}
$$

일반적인 로봇의 경우, 설정 공간은 열 벡터 $\theta = [\theta_1 \cdots \theta_n]^T \in R^n$와 다음 형태의 루프 폐쇄 방정식으로 암시적으로 표현될 수 있습니다. 이는 $k$개의 독립적인 방정식 세트이며, $k \le n$입니다. 이러한 제약 조건은 $\text{C-space}$의 차원을 줄이는 홀로노믹 제약 조건(holonomic constraints)으로 알려져 있습니다. $\text{C-space}$는 $R^n$에 포함된 차원 $n-k$의 표면으로 간주될 수 있습니다.

닫힌 사슬 로봇이 시간 궤적 $\theta(t)$를 따라 움직인다고 가정하고, $g(\theta(t)) = 0$의 양변을 $t$에 대해 미분하면 다음을 얻습니다.

$$
\frac{\partial g}{\partial \theta}(\theta) \dot{\theta} = 0
$$

여기서 $\dot{\theta}$는 조인트 속도 벡터이고, $\frac{\partial g}{\partial \theta}(\theta) \in R^{k \times n}$입니다. 이러한 형태의 속도 제약 조건을 파피안 제약 조건(Pfaffian constraints)이라고 합니다. $A(\theta) = \frac{\partial g}{\partial \theta}(\theta)$인 경우, $g(\theta)$를 $A(\theta)$의 적분으로 간주할 수 있습니다. 이러한 이유로 $g(\theta) = 0$ 형태의 홀로노믹 제약 조건은 또한 적분 가능 제약 조건(integrable constraints)이라고 불립니다.

<img src="https://velog.velcdn.com/images/devjo/post/3676bf2b-e3ae-4894-a5cc-6debe9e553cd/image.png" alt="Example Image" style="display: block; margin: 0 auto; height:150;" />

또 다른 종류의 파피안 제약 조건을 고려합니다. 구체적인 예로, 평면 위를 구르는 반지름 $r$인 세워진 동전을 생각하면 평면 위의 접촉점 $(x, y)$, 조향 각도 $\phi$, 그리고 회전 각도 $\theta$로 주어진 설정에 따라 $\text{C-space}$는 $R^2 \times T^2$이며, 이는 4차원입니다. 동전은 항상 $r\dot{\theta}$의 전진 속도로 $(\cos \phi, \sin \phi)$가 나타내는 방향으로 구르어야 합니다.

$$
\begin{bmatrix} \dot{x} \\ \dot{y} \end{bmatrix} = r \dot{\theta} \begin{bmatrix} \cos \phi \\ \sin \phi \end{bmatrix}
$$

$\text{C-space}$ 좌표를 하나의 벡터 $q = [q_1 q_2 q_3 q_4]^T = [x y \phi \theta]^T \in R^2 \times T^2$로 모으면, 위의 미끄러짐 없는 구름 제약 조건은 다음 형태로 표현될 수 있습니다.

$$
\begin{bmatrix} 1 & 0 & 0 & -r \cos q_3 \\ 0 & 1 & 0 & -r \sin q_3 \end{bmatrix} \dot{q} = 0
$$

이것은 $A(q) \dot{q} = 0$ 형태의 파피안 제약 조건이며 적분 불가능합니다. 이를 비홀로노믹 제약 조건(nonholonomic constraint)이라고 하는데 시스템의 실현 가능한 속도의 차원을 줄이지만 도달 가능한 $\text{C-space}$의 차원을 줄이지는 않습니다.

#### Task Space and Workspace

작업 공간은 로봇의 작업이 자연스럽게 표현될 수 있는 공간입니다. 예를 들어, 로봇의 작업이 종이에 펜으로 그리는 것이라면, 작업 공간은 $R^2$일 것입니다. 워크스페이스는 로봇의 엔드 이펙터가 도달할 수 있는 설정의 사양입니다. 워크스페이스의 정의는 작업과는 독립적으로 주로 로봇의 구조에 의해 좌우됩니다.

---

### 참고 자료

[원본 경로 #1](https://hades.mech.northwestern.edu/images/7/7f/MR.pdf)

