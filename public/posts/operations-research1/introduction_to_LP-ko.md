---
title: 'Introduction to LP'
date: '2024-07-08'
tags: ['Operations Research 1', 'lecture']
---

### Linear Function & Inequality

선형 함수는 $f(x_1, x_2, ..., x_n)=c_1x_1 + c_2x_2 + ... + c_nx_n$과 같은 형태로 구성이 되는 경우를 말합니다. 여기서 $c_1, c_2, ..., c_n$은 상수입니다. 모든 선형 함수는 상수 $b$에 대해 부등호로 $f(x_1, x_2, ..., x_n) \ge b, f(x_1, x_2, ..., x_n) \le b$로 표현되는 경우를 선형 부등식이라고 합니다.

---

### Linear Programming(LP)

LP 문제는 아래와 같은 문제들의 최적화를 위한 계획법입니다.

-결정 변수의 선형 목적식의 최적화

-모든 제약 조건은 선형 방정식 또는 선형 부등식이어야 합니다.

-부호 제한은 각 결정 변수에 관련이 있습니다. 모든 $x_i$에 대해서 양수, 0, 음수와 같이 unrestricted in sign에 따라 부호에 제한이 없어야 합니다.

예를 들어 $P_1$은 raw material($1000)에 2, labor cost($1000)에 5, machining time(9hr)에 2, packaging time(9hr)에 1, selling price($1000)에 10을 책정하고 $P_2$는 raw material($1000)에 2, labor cost($1000)에 4, machining time(9hr)에 1, packaging time(9hr)에 2, selling price($1000)에 8을 책정한 상태에서 최적화 문제를 풀이해보면,

결정 변수에 $x_1$는 $P_1$이 하루에 생산하는 단위, $x_2$는 $P_2$가 하루에 생산하는 단위라고 정의합니다. 그리고 목적식으로 하루의 생산 이익(Revenue-Cost)을 최적화하기 위하여 $z=(10x_1+8x_2) - [(2+5)x_1 + (2+4)x_2] = 3x_1+2x_2$와 같이 정의합니다. 마지막으로 제약 조건은 $2x_1+x_2 \le 9$, $x_1+2x_2 \le 9$, $x_1, x_2 \ge 0$으로 정의합니다.

따라서 아래와 같이 최종 수식을 작성합니다.

$$
max \\
z = 3x_1 + 2x_2 (in \rightarrow 1000) \\
s.t \\ 
2x_1+x_2 \le 9 \\
x_1+2x_2 \le 9 \\
x_1, x_2 \ge 0
$$

---

### graphically solving LP

최대화 문제의 경우는 실현 가능 영역(feasible region)에서 목적 함수 값이 가장 큰 지점이고 최소화 문제의 경우는 실현 가능 영역에서 목적 함수 값이 가장 작은 지점입니다.

우선 실현 가능 영역을 찾고 목적 함수의 기울기에 따라서 선을 그려 나갑니다. 최대/최소 문제에 따라 방향을 다르게 선을 이동해야 합니다. 마지막으로 실현 가능 영역을 벗어나기 전 교차점이 최적해가 됩니다.

<img src="https://velog.velcdn.com/images/ski06043/post/36a1b114-8f54-438f-890c-b2428bb718b0/image.png" style="display: block; margin: 0 auto; height:200;" />

위의 예시에서 목적 함수의 기울기를 구하려면 $z=3x_1+2x_2 \rightarrow x_2=z/2-3x_1/2$로 기울기 $s=-\frac{3}{2}$가 구해집니다. 이 기울기를 갖는 임의의 점선을 생각하고 두 변수의 증가에 따라 목적 함수의 방향은 증가하는 방향이 되므로 우상단으로 이동을 시킵니다. 마지막으로 (3,3)이 두 제약 조건의 교차점이므로 이를 대입한 목적 함수의 값 15가 최적해가 됩니다.

---

### binding & nonbinding constraints

제약조건은 LHS, RHS가 최적해에서 같을 때 구속력이 있습니다. 예를 들어 위와 동일한 제약조건 상에서 $z = 3x_1+2x_2$라는 목적식이 있는 경우 기울기는 -3이고 최적해는 (4.5, 0)에서 결정됩니다. 이 최적해를 $c_1 : 2x_1 + x_2 \le 9$와 $c_2 : x_1 + 2x_2 \le 9$에 대입하면 $c_1$에서는 9로 동일하므로 binding하지만 $c_2$에서는 9보다 작으므로 nonbinding합니다. 그리고 $s_1 : x_1 \ge 0$, $s_2 : x_2 \ge 0$에서도 동일하게 확인해보면 $s_1$에서는 0보다 크므로 nonbinding하고 $s_2$에서는 0과 동일하므로 binding합니다.

---

### convex set & convex function

$n$차원의 실수 공간에 두 점 $x$, $y$가 주어져 있을 때 $z=\lambda x + (1-\lambda)y$, $\lambda \in [0,1]$의 모든 볼록 조합에 속한다고 하면,

예를 들어 $\lambda = 0.3$이면 $z$는 30%의 $x$와 70%의 $y$ 조합임을 의미합니다.

$n$차원의 실수 공간에 집합 $S$가 그 안의 모든 두 점의 볼록 조합을 포함하는 경우 이 집합을 볼록 집합이라고 합니다. 여기서 공집합과 단일 점에 관한 집합, 교집합 볼록도 볼록 집합이라고 합니다.

<img src="https://velog.velcdn.com/images/ski06043/post/2dbc64c2-5a7e-44b7-897a-7977df581c18/image.png" style="display: block; margin: 0 auto; height:200;" />

$S$를 볼록 집합이라고 할 때 $f : S \rightarrow R$를 만족하는 볼록 함수인 경우 $S$에 있는 두 점 $x_1$, $x_2$에 대해 $f(\lambda x_1 + (1-\lambda)x_2) \le \lambda f(x_1) + (1-\lambda)f(x_2)$가 성립하는 경우는 두 점의 볼록 조합함수가 두 점의 함수 값의 볼록 조합보다 작거나 같다는 의미로 graphic적으로 생각하면 함수 $f$는 두 점 사이에 형성된 interpolation보다 작으면 볼록하다고 할 수 있기 때문입니다. 반대로 interpolation보다 크다면 오목하다고 할 수 있습니다.

---

### extreme point

$P$라는 임의의 점이 볼록 집합 $S$에 속하고 $P$를 포함하면서 $S$의 내부에 완전히 포함된 모든 선분에 대해 $P$가 끝점에 해당할 경우 극점이 될 수 있습니다. 예를 들어 삼각형과 같은 공간 $S$가 있을 때 $A$, $B$, $C$와 같은 꼭짓점이 극점이라고 생각하면 됩니다.

---

### LP problems

#### 1. staff scheduling problem

예를 들어 한 회사에서 필요한 직원의 수가 주중에 상이하고 월요일(10), 화요일(12), 수요일(20), 목요일(17), 금요일(15), 토요일(12), 일요일(5)와 같으며 각 직원은 5일 연속 일해야 하면서 이후 2일은 휴가를 받아야 한다면 회사 입장에서 고용인원의 최소 수를 LP문제로 공식화할 수 있습니다.

잘못된 방법을 우선 보이면,

$x_i$를 $i$일에 근무하는 직원 수로 결정 변수를 정하고 min $z = x_1+x_2+x_3+x_4+x_5+x_6+x_7$ 라는 목적식과 $x_1 \ge 10$, $x_2 \ge 12$, $x_3 \ge 20$, $x_4 \ge 17$, $x_5 \ge 15$, $x_6 \ge 12$, $x_7 \ge 5$, $x_i \ge 0$이라는 제약조건들을 정합니다. 이렇게 되면 일수마다 직원 수를 중복으로 계산할 수 있기에 부적절한 결정 변수를 수정해야만 합니다.

<img src="https://velog.velcdn.com/images/ski06043/post/5a58cb3b-5cc9-462f-add6-d7ad9dbc9f02/image.png" style="display: block; margin: 0 auto; height:200;" />

$x_i$를 이제 $i$일에 일을 시작하는 직원 수로 수정합니다. 이렇게 되면 이미지처럼 월요일~일요일까지 근무하는 인원들이 중복 없이 계산이 될 것입니다. 이 상황에서의 목적 함수는 위와 동일하게 min $z = x_1+x_2+x_3+x_4+x_5+x_6+x_7$이지만 제약조건들은 $x_1 + x_4 + x_5 + x_6 + x_7 \ge 10$, $x_1 + x_2 + x_5 + x_6 + x_7 \ge 12$, $x_1 + x_2 + x_3 + x_6 + x_7 \ge 20$, $x_1 + x_2 + x_3 + x_4 + x_7 \ge 17$, $x_1 + x_2 + x_3 + x_4 + x_5 \ge 15$, $x_2 + x_3 + x_4 + x_5 + x_6 \ge 12$, $x_3 + x_4 + x_5 + x_6 + x_7 \ge 5$, $x_i \ge 0$와 같이 수정해야 합니다.

#### 2. blending problem

blending problem에서는 다양한 투입물들을 원하는 비율로 혼합하여 최종 제품을 생산합니다.

예를 들어 limestone, corn, soybean의 영양정보가 cal(0.38)/cal(0.001)/cal(0.002), protein(0)/protein(0.09)/protein(0.5), fiber(0)/fiber(0.02)/fiber(0.08)와 같이 존재하고 cal $\ge 0.008$, cal $\le 0.012$, protein $\ge 0.22$, fiber $\le 0.05$, limestone price(0.1), corn price(0.2), soybean price(0.4)로 부가정보가 있습니다.

모든 구성요소를 합쳐 1kg을 만든다고 할 때 min $z=0.1L + 0.2C + 0.4S$로 목적 함수를 만들 수 있을 것이고 제약조건으로는 $L+C+S=1$, $0.008 \le 0.38L+0.001C+0.002S \ge 0.012$, $0.22 \le 0.09C+0.5S \le 1$, $0 \le 0.02C+0.08S \le 0.05$ 와 같이 설정하면 됩니다.

#### 3. production process problem

예를 들어 어떤 회사가 원자재를 한 주에 2000units을 사용하고 노동력이 한 주에 6000hr 가용 가능하다고 할 때 $p_1$, $p_2$, $l_1$, $l_2$라는 4가지 품목을 생산한다고 합시다.

1unit 원자재는 1hr 이후 $3p_1$과 $4p_2$를 생산할 수 있다고 합니다. $p_1$ 한 단위를 처리하는데 5달러와 3hr을 투자하면 $1l_1$을 얻을 수 있다고 합니다. $p_2$ 한 단위를 처리하는데 4달러와 2hr을 투자하면 $1l_2$를 얻을 수 있다고 합니다. 원자재 1unit은 3달러, $p_1$은 7달러, $p_2$는 6달러, $l_1$은 17달러, $l_2$는 16달러에 가격 형성이 되어 있습니다. 이 때 주간 판매량의 최대화를 위한 결정 변수, 목적 함수, 제약 조건 등은 아래와 같습니다.

$x_{rm}$은 $rm$의 주간 구매량, $x_{p1}$은 $p_1$의 주간 판매량, $x_{p2}$은 $p_2$의 주간 판매량, $x_{l1}$은 $l_1$의 주간 판매량, $x_{l2}$은 $l_2$의 주간 판매량으로 정합니다.

목적 함수는 max $z = 7x_{p1} + 6x_{p2} + 17x_{l1} + 16x_{l2} - (3x_{rm}+5x_{l1}+4x_{l2}) = 6x_{p1} + 6x_{p2} + 11x_{l1} + 12x_{l2}$ 와 같이 생각할 수 있고 제약 조건으로는 $x_{rm} \le 2000$, $x_{rm} + (3x_{l1} + 2x_{l2}) \le 6000$, $x_{p1}+x_{l1}-3x_{rm}=0$, $x_{p2} + x_{l2}-4x_{rm}=0$, $x_* \ge 0$으로 만들면 됩니다.

$x_{rm} = 2000$으로 잡으면 $3x_{l1} + 2x_{l2} \le 4000$, $x_{p1} + x_{p2} + x_{l1} + x_{l2} = 7x_{rm} = 14000$, $x_{p1} + x_{l1} = 6000$, $x_{p2} + x_{l2} = 8000$ 으로 각 직선의 기울기와 교차점을 통해 최대화를 위한 각 결정 변수 값들을 구할 수 있습니다. 처음으로 직선을 그리게 될 것은 $3x_{l1} + 2x_{l2} \le 4000$로 이는 기울기는 $-3/2$에 해당하며 절편은 $(0, 2000)$, $(4000/3, 0)$이 됩니다. 다음으로 목적 함수에서 6으로 묶어서 계산하고 남는 $5x_{l1} + 6x_{l2}$가 갖는 최대 값은 기울기 $-5/6$로 직전 직선보다 기울기가 작으므로 절편인 $(0, 2000)$을 지날 때 최대가 됩니다. 따라서 모든 결정 변수를 정리하면 $x_{rm}=2000$, $x_{p1}=6000$, $x_{p2}=6000$, $x_{l1}=0$, $x_{l2}=2000$, $z=6*14000+6*2000=96000$이 됩니다.

#### 4. multiperiod inventory problem

예를 들어 한 회사가 3달 동안의 고정 생산 스케줄링을 수립하고자 합니다. 이 때 $m_1:200$, $m_2:150$, $m_3:400$ 으로 각 달마다의 수요가 요구되며 정규 노동시간으로 제조 시에 2000달러, 연장 근로로 제조 시에 3000달러, 수요보다 공급이 과잉되어 보관비용 발생 시에 500달러가 발생함을 정합니다. 정규 노동시간으로는 달마다 최대 200개 생산 가능합니다. 연장 근로로는 제한이 없으며 초기 보유비용은 없는 대신 10개의 제품은 보유 중입니다.

3달 동안 비용의 최소화를 목적으로 하는 결정 변수, 목적 함수, 제약 조건은 아래와 같습니다.

우선 결정 변수는 $x_t$는 정규 노동시간에 생산되는 제품의 개수, $y_t$ 연장 근로로 생산되는 제품의 개수, $i_t$는 월말에 보유량으로 정합니다. 목적 함수는 min $z = 2000*(x_1+x_2+x_3) + 3000*(y_1+y_2+y_3) + 500*(i_1+i_2+i_3)$ 과 같이 생각할 수 있습니다. 제약 조건으로는 $x_1 \le 200$, $x_2 \le 200$, $x_3 \le 200$, $i_1=10+x_1+y_1-200$, $i_2=i_1+x_2+y_2-150$, $i_3=i_2+x_3+y_3-400$으로 정리할 수 있습니다.

---

### 참고 자료

[원본 경로 #1](https://youtu.be/gHNCqwNMvds?si=PurS1k5XjtHMUzSD)

[원본 경로 #2](https://youtu.be/7vHM_YUxxkM?si=Ft2JqCJI2R0G_VgM)

[원본 경로 #3](https://youtu.be/_mNxWyyF26Q?si=OyakJPZojLB5iqhG)

[원본 경로 #4](https://youtu.be/po06JU0c8ME?si=_YhniEKmMSd-GUSY)

[원본 경로 #5](https://youtu.be/s71-XbHubSM?si=7voIaQ4MWx-Fd2SX)

[원본 경로 #6](https://youtu.be/a_gRfwHUlhQ?si=mEeULj3UQBjtYX-k)

[원본 경로 #7](https://youtu.be/qcoJfjRwn3A?si=WPLYpzGYg8Wo97x2)

[원본 경로 #8](https://youtu.be/3I8B21M-ob8?si=6k0vQzQiWXPepLxU)

[원본 경로 #9](https://youtu.be/eUd6k_nZpL8?si=k-VR09bWrvUe2IxL)

[원본 경로 #10](https://youtu.be/dfC9rDco0yU?si=JJ3fNXF8bnMKNEil)

[원본 경로 #11](https://youtu.be/2802Tan11Tg?si=VagTRL6GUVd4vyfS)



