---
title: 'Solving LP problems : Simplex method'
date: '2024-07-12'
tags: ['Operations Research 1', 'lecture']
---

### standard LP form

simplex로 LP 문제를 풀기에 앞서 표준 형식으로 변환하여야 합니다. 모든 제약 조건이 방정식이고 모든 결정 변수가 음수가 아니어야 합니다. 제약 조건에 부등식이 있고 부등호의 방향이 $\le$인 경우 slack variables($s_i$)를 추가시켜 방정식으로 바꾸고 그 값도 음수가 되지 않도록 하면 됩니다. 반대 방향인 경우 excess variables($e_i$)를 빼도록 하여 방정식으로 바꾸고 역시 그 값도 음수가 되지 않도록 하면 됩니다.

따라서 standard form은 아래와 같습니다.

$$
max \\
z = c^Tx \\
s.t \\ 
Ax=b \\
x \ge 0
$$

---

### basic feasible solution

standard form에서는 $n$개의 변수와 $m$개의 제약 조건을 갖도록 합니다 ($n \ge m$). 기본적인 솔루션으로는 $n$개의 변수 중 $m$개를 선택하거나 $n$개의 변수 중 $n-m$을 선택하는 것으로 NBV를 구합니다. 이는 $\frac{n!}{m!(n-m)!}$으로 계산됩니다.

기본 솔루션에서 모든 변수가 음수가 아닌 경우를 기본적인 실행 가능 솔루션(BFS)이라고 하게 됩니다.

예를 들어 아래와 같은 LP 문제가 있을 때,

$$
max \\
z = 3x_1 + 2x_2 \\
s.t \\ 
2x_1+x_2 \le 9 \\
x_1+2x_2 \le 9 \\
x_i \ge 0 (i = 1,2)
$$

여기서 부등호의 방향에 따라 slack variables를 추가하도록 합니다.

$$
max \\
z = 3x_1 + 2x_2 \\
s.t \\ 
2x_1+x_2+s_1 = 9 \\
x_1+2x_2+s_2 = 9 \\
x_i \ge 0 (i = 1,2); s_i \ge 0 (i=1,2)
$$

이렇게 되면 4개의 $n$과 2개의 $m$이 있게 되어 $n-m=2$ NBV, $m=2$ BV가 됩니다. 이를 계산하면 $\begin{pmatrix} n \\ m \end{pmatrix} = 6$입니다. 아래와 같은 도표로 모두 정리하였습니다.

| NBV 조합 | BV 조합 | BFS 여부($x_1, x_2$) |
|----------|---------|----------|
| $x_1,x_2 \rightarrow x_1=x_2=0$ | $s_1,s_2 \rightarrow s_1=9, s_2=9$ | Y |
| $x_1,s_1 \rightarrow x_1=s_1=0$ | $x_2,s_2 \rightarrow x_2=9, s_2=-9$ | N |
| $x_1,s_2 \rightarrow x_1=s_2=0$ | $x_2,s_1 \rightarrow x_2=4.5, s_1=4.5$ | Y |
| $x_2,s_1 \rightarrow x_2=s_1=0$ | $x_1,s_2 \rightarrow x_1=4.5, s_2=4.5$ | Y |
| $x_2,s_2 \rightarrow x_2=s_2=0$ | $x_1,s_1 \rightarrow x_1=9, s_1=-9$ | N |
| $s_1,s_2 \rightarrow s_1=s_2=0$ | $x_1,x_2 \rightarrow x_1=3, x_2=3$ | Y |

LP의 feasible region은 볼록 집합입니다. 그리고 BFS는 실행 가능한 영역의 극점입니다. LP는 유한한 BFS가 존재합니다. 이는 극단점의 수가 한정되어 있기 때문입니다. 마지막으로 LP 문제에 최적의 솔루션이 있다면 유한한 극점이 아닌 최적의 극단점(선도 가능)이 있어야 합니다.

#### adjacent BFS

$m$개의 제약 조건이 있는 모든 LP에 대해 두 BFS가 공통적으로 $m-1$개의 BV를 갖고 있다면 두 BFS는 인접합니다. 위의 도표를 보면 1번 BFS와 인접한 BFS는 $s_1$과 $s_2$ 중 적어도 1개가 겹치면서 BFS가 Y인 것이므로 3,4번이 해당합니다.

---

### entering variable, leaving variable, ratio test and pivoting

$$
max \\
z = 3x_1 + 2x_2 \\
s.t \\ 
2x_1+x_2+s_1 = 9 \\
x_1+2x_2+s_2 = 9 \\
x_i \ge 0 (i = 1,2); s_i \ge 0 (i=1,2)
$$

이러한 standard form에서 목적 함수를 좌항으로 모두 옮겨 $z-3x_1-2x_2 = 0$으로 변경합니다. 이를 $R_0$이라 하고 제약 조건들은 각각 $R_1$, $R_2$로 표시합니다. 이러한 구조를 단순형 표준형(simplex canonical form)이라고 합니다. 아래는 이를 기반으로 simplex tableau를 만들 수 있습니다.

| $z$ | $x_1$ | $x_2$ | $s_1$ | $s_2$ | RHS |
|----------|---------|----------|---------|----------|----------|
| 1 | -3 | -2 | 0 | 0 | 0 |
| 0 | 2 | 1 | 1 | 0 | 9 |
| 0 | 1 | 2 | 0 | 1 | 9 |

$n$은 4개, $m$은 2개로 $n-m$은 2 NBV이기 때문에 $\begin{pmatrix} n \\ m \end{pmatrix} = 6$가 됩니다. 일반적으로 제약 조건의 RHS가 음수가 아닌 경우 slack variables를 BV로 사용할 수 있습니다. 음수일 경우 부호 제한을 위반하기 때문입니다.

다른 모든 NBV를 0으로 유지하면서 현재 값인 0에서 일부 NBV를 증가시키면 개선할 수 있을지를 보면 예를 들어 두 NBV를 $x_1$, $x_2$일 때 $x_1$을 0에서 1로 증가시키면 $z$는 3으로 증가합니다. 또한 $x_2$를 0에서 1로 증가시키면 $z$는 2로 증가합니다. 따라서 하나가 증가되면 $z$는 개선이 되는 것을 알 수 있습니다.

이처럼 $x_1$이 증가하면 BV 집합에 진입하므로 이를 entering variable이라고 합니다. ratio test에서 입력 변수가 양의 계수를 갖는 모든 제약 조건에 대한 비율을 rhs of constraint row/coef of entering var in constraint row로 계산하여야 합니다. 가장 작은 비율을 갖는 제약조건을 ratio test의 승자라고 합니다. 위의 simplex tableau에서 $R_1$ 행을 보면 $x_1$이 0일 때 $s_1=9$였지만 1로 증가 시에 $s_1 = 9-2x_1 \ge 0 \rightarrow x_1 \le 9/2$가 되어 ratio는 9/2로 반영이 됩니다. 마찬가지로 $R_2$ 행에서는 1로 증가 시에 $s_2 = 9-x_1 \ge 0 \rightarrow x_1 \le 9$가 되어 ratio는 9로 반영이 됩니다. 이 때 ratio test의 승자(=pivot row)는 $R_1$이 되며 다른 모든 행에서 계수가 0이 되도록 하려면 이제 기본 행 연산(ERO)를 사용해야 한다는 의미입니다. $x_1$을 entering variable로 설정하고 BV로 편입이 되는 순간 기존 BV였던 $s_1$은 leaving variable이 됩니다. 아래에는 ERO를 수행하는 것을 보여드리겠습니다.

| $z$ | $x_1$ | $x_2$ | $s_1$ | $s_2$ | RHS |
|----------|---------|----------|---------|----------|----------|
| 1 | -3 | -2 | 0 | 0 | 0 |
| 0 | $2 \rightarrow 1$ | $1 \rightarrow 1/2$ | $1 \rightarrow 1/2$ | 0 | $9 \rightarrow 9/2$ |
| 0 | 1 | 2 | 0 | 1 | 9 |

| $z$ | $x_1$ | $x_2$ | $s_1$ | $s_2$ | RHS |
|----------|---------|----------|---------|----------|----------|
| 1 | $-3 \rightarrow 0$ | $-2 \rightarrow -1/2$ | $0 \rightarrow 3/2$ | 0 | $0 \rightarrow 27/2$ |
| 0 | 1 | 1/2 | 1/2 | 0 | 9/2 |
| 0 | 1 | 2 | 0 | 1 | 9 |

| $z$ | $x_1$ | $x_2$ | $s_1$ | $s_2$ | RHS |
|----------|---------|----------|---------|----------|----------|
| 1 | 0 | -1/2 | 3/2 | 0 | 27/2 |
| 0 | 1 | 1/2 | 1/2 | 0 | 9/2 |
| 0 | $1 \rightarrow 0$ | $2 \rightarrow 3/2$ | $0 \rightarrow -1/2$ | 1 | $9 \rightarrow 9/2$ |

ERO를 마치고 나서 BV는 $x_1$, $s_2$가 되며 NBV는 $x_2$, $s_1$으로 변하게 됩니다. NBV를 모두 0으로 두고 계산한 BV에서 $z=27/2$가 되어 피벗팅 이후 가장 큰 z값을 가진 인접한 BFS로 이동했다는 것을 알 수 있습니다. 다만 다시 $z$를 좌변으로 옮긴 목적 함수를 살펴보면 $z = 27/2 + x_2/2 - 3s_1/2$가 되어 NBV를 증가시키면 $z$가 개선될 여지는 여전히 가장 큰 음의 계수인 $x_2$를 변화시킨다면 가능합니다.

아래에는 두번째 ratio test를 진행하는 과정입니다.

$R_1'$에서 $x_1 = 9/2 \rightarrow x_1 = 9/2 - x_2/2 \ge 0$으로 $x_2 \le 9$를 만족하게 되고 $R_2'$에서는 $s_x=9/2 \rightarrow s_2=9/2-3x_2/2 \ge 0$으로 $x_2 \le 3$을 만족합니다. 따라서 $R_2'$가 피벗 행이 됩니다. 아래에 다시 ERO를 진행하는 과정을 보이겠습니다.

| $z$ | $x_1$ | $x_2$ | $s_1$ | $s_2$ | RHS |
|----------|---------|----------|---------|----------|----------|
| 1 | 0 | -1/2 | 3/2 | 0 | 27/2 |
| 0 | 1 | 1/2 | 1/2 | 0 | 9/2 |
| 0 | 0 | $3/2 \rightarrow 1$ | $-1/2 \rightarrow -1/3$ | $1 \rightarrow 2/3$ | $9/2 \rightarrow 3$ |

| $z$ | $x_1$ | $x_2$ | $s_1$ | $s_2$ | RHS |
|----------|---------|----------|---------|----------|----------|
| 1 | 0 | $-1/2 \rightarrow 0$ | $3/2 \rightarrow 4/3$ | $0 \rightarrow 1/3$ | $27/2 \rightarrow 15$ |
| 0 | 1 | 1/2 | 1/2 | 0 | 9/2 |
| 0 | 0 | 1 | -1/3 | 2/3 | 3 |

| $z$ | $x_1$ | $x_2$ | $s_1$ | $s_2$ | RHS |
|----------|---------|----------|---------|----------|----------|
| 1 | 0 | 0 | 4/3 | 1/3 | 15 |
| 0 | 1 | $1/2 \rightarrow 0$ | $1/2 \rightarrow 2/3$ | $0 \rightarrow -1/3$ | $9/2 \rightarrow 3$ |
| 0 | 0 | 1 | -1/3 | 2/3 | 3 |

이제 BV는 $x_1$, $x_2$이고 나머지가 NBV로 변경됩니다. NBV를 0으로 둔 $z$값은 이제 15가 되며 NBV를 증가시켜도 개선이 되지 않는 지금의 BFS가 최적이라고 할 수 있습니다.

---

### the big m method

simplex method에서는 시작할 초기 BFS를 찾아야 합니다. 위에서는 slack variables 등을 사용해서 찾도록 하였습니다. 이는 =, $\ge$ 상황에서는 해당하지 않았습니다.

$$
max \\
z = 3x_1 + 2x_2 \\
s.t \\ 
2x_1+x_2 \le 9 \\
x_1+2x_2 \ge 9 \\
x_i \ge 0 (i = 1,2)
$$

big m 방법은 우선 제약 조건의 RHS가 음수가 아닌지 확인하여 음수라면 -1을 곱하도록 합니다. 예시에서는 양수이므로 넘어갑니다. 다음으로는 standard form 으로 변경해야 합니다. 이 다음으로는 =, $\ge$ 상황에 양수인 인공 변수($a_i$)를 추가합니다. 그리고 매우 큰 양수로서 $M$을 $a_i$와 곱해서 목적 함수 행에 추가되도록 합니다. 이는 추가하였던 인공 변수가 양수가 되는데 엄청난 비용이 들게 합니다.

$$
max \\
z-3x_1-2x_2+Ma_2=0 \\
s.t \\ 
2x_1+x_2+s_1 = 9 \\
x_1+2x_2-e_2+a_2 = 9 \\
x_i \ge 0 (i = 1,2); s_1, e_2, a_2 \ge 0
$$

이를 simplex tableau로 아래와 같이 나타내고, 인공 변수가 양수이면 가짜 최적 솔루션을 갖게 되기 때문에 목적 함수에서 인공 변수들을 지워야 합니다.

| $z$ | $x_1$ | $x_2$ | $s_1$ | $e_2$ | $a_2$ | RHS |
|----------|---------|----------|---------|----------|----------|----------|
| 1 | -3 | -2 | 0 | 0 | M | 0 |
| 0 | 2 | 1 | 1 | 0 | 0 | 9 |
| 0 | 1 | 2 | 0 | -1 | 1 | 9 |

따라서 $R_0$에서 동일하게 인공 변수가 포함된 $R_2$에 $M$을 곱한 값을 빼면 아래와 같이 변합니다.

| $z$ | $x_1$ | $x_2$ | $s_1$ | $e_2$ | $a_2$ | RHS |
|----------|---------|----------|---------|----------|----------|----------|
| 1 | $-3 \rightarrow -3-M$ | $-2 \rightarrow -2-2M$ | 0 | $0 \rightarrow -M$ | $M \rightarrow 0$ | $0 \rightarrow -9M$ |
| 0 | 2 | 1 | 1 | 0 | 0 | 9 |
| 0 | 1 | 2 | 0 | -1 | 1 | 9 |

위의 도표에서 BV는 $z=-9M$, $s_1=9$, $a_2=9$가 되며 entering variable은 가장 큰 음의 계수인 $x_2$가 됩니다. ratio test를 진행하면 $R_1 : 9/1$, $R_2 : 9/2$로 더 작은 비율인 $R_2$가 피벗 행이 되었습니다. 따라서 $R_2$의 $x_2$를 1로 만들고 ERO를 진행합니다.

| $z$ | $x_1$ | $x_2$ | $s_1$ | $e_2$ | $a_2$ | RHS |
|----------|---------|----------|---------|----------|----------|----------|
| 1 | -2 | 0 | 0 | -1 | 1+M | 9 |
| 0 | 3/2 | 0 | 1 | 1/2 | -1/2 | 9/2 |
| 0 | 1/2 | 1 | 0 | -1/2 | 1/2 | 9/2 |

이렇게 완성한 ERO에서의 BV는 $x_2=9/2$, $s_1=9/2$이고 $z=9$입니다. 하지만 아직 $z$가 개선될 여지가 있기 때문에 가장 큰 음의 계수인 $x_1$이 entering variable이 되고 ratio test를 진행하면 $R_1 : \frac{9/2}{3/2}=3$, $R_2 : \frac{9/2}{1/2}=9$이므로 $R_1$을 피벗 행으로 합니다.

| $z$ | $x_1$ | $x_2$ | $s_1$ | $e_2$ | $a_2$ | RHS |
|----------|---------|----------|---------|----------|----------|----------|
| 1 | 0 | 0 | 4/3 | -1/3 | 1/3+M | 15 |
| 0 | 1 | 0 | 2/3 | 1/3 | -1/3 | 3 |
| 0 | 0 | 1 | -1/3 | -2/3 | 2/3 | 3 |

이렇게 추가 진행한 ERO에서의 BV는 $x_1=3$, $x_2=3$이고 $z=15$입니다. 하지만 아직 $z$가 개선될 여지가 있기 때문에 가장 큰 음의 계수인 $e_2$가 entering variable이 되고 ratio test를 진행하면 $R_1 : \frac{3}{1/3}=9$, $R_2$는 해당 계수가 음수로 none이므로 $R_1$을 피벗 행으로 합니다.

| $z$ | $x_1$ | $x_2$ | $s_1$ | $e_2$ | $a_2$ | RHS |
|----------|---------|----------|---------|----------|----------|----------|
| 1 | 1 | 0 | 2 | 0 | M | 18 |
| 0 | 3 | 0 | 2 | 1 | -1 | 9 |
| 0 | 2 | 1 | 1 | 0 | 0 | 9 |

이렇게 추가 진행한 ERO에서의 BV는 $x_2=9$, $e_2=9$이고 $z=18$입니다. 나머지 NBV인 $x_1$, $s_1$는 모두 0으로 합니다. 이 때 인공 변수도 0이 되므로 이는 완전한 최적화 솔루션이라고 할 수 있습니다.

---

### unrestricted in sign variable and smoothing scheduling

linear programming에서 기존에는 무조건 0보다 크거나 같은 $x_i$ 변수에 대해 풀이해왔다면 그 반대의 경우 $-x \rightarrow y$변수와 같이 $x_i^+$를 0으로부터의 양의 편차, $x_i^-$를 0으로부터의 음의 편차를 나타내도록 설정하는 것을 unrestricted in sign variable(URS)라고 합니다.

모든 BFS에 대해서 URS 상황은 3가지 중에 하나가 성립합니다.

1.$x_i^+ > 0$ and $x_i^- = 0$은 $x_i=x_i^+-x_i^-=x_i^+$이 성립될 때의 상태

2.$x_i^+ = 0$ and $x_i^- > 0$은 $x_i=x_i^+-x_i^-=-x_i^-$이 성립될 때의 상태

3.$x_i^+ = x_i^- = 0$은 $x_i=x_i^+-x_i^-=0$이 성립될 때의 상태

$$
max \\
z = 3x_1 + 2x_2 \\
s.t \\ 
2x_1+x_2 \le 9 \\
x_1+2x_2 \le 9 \\
x_1 \ge 0, x_2=urs
$$

이와 같은 예시가 있을 때, simplex method에 의하여 각 제약 조건에 $s_1$, $s_2$를 추가합니다. 그리고 urs 변수인 $x_2$에 대해서 편차 변수로 변경합니다.

$$
max \\
z-3x_1-2x_2^+ + 2x_2^-=0 \\
s.t \\ 
2x_1+x_2^+-x_2^-+s_1 = 9 \\
x_1+2x_2^+-2x_2^-+s_2 = 9 \\
x_1, s_1, s_2, x_2^+, x_2^- \ge 0
$$

이를 simplex tableau로 만들면 아래와 같습니다.

| $z$ | $x_1$ | $x_2^+$ | $x_2^-$ | $s_1$ | $s_2$ | RHS |
|----------|---------|----------|---------|----------|----------|----------|
| 1 | -3 | -2 | 2 | 0 | 0 | 0 |
| 0 | 2 | 1 | -1 | 1 | 0 | 9 |
| 0 | 1 | 2 | -2 | 0 | 1 | 9 |

여기서 BV는 $s_1=9$, $s_2=9$과 $z=0$이고 entering variable은 $R_0$에서 가장 큰 음수 계수를 가진 $x_1$이 됩니다. ratio test를 진행하면 $R_1 : 9/2$, $R_2 : 9/1$로 $R_1$이 피벗 행이 됩니다.

| $z$ | $x_1$ | $x_2^+$ | $x_2^-$ | $s_1$ | $s_2$ | RHS |
|----------|---------|----------|---------|----------|----------|----------|
| 1 | 0 | -1/2 | 1/2 | 3/2 | 0 | 27/2 |
| 0 | 1 | 1/2 | -1/2 | 1/2 | 0 | 9/2 |
| 0 | 0 | 3/2 | -3/2 | -1/2 | 1 | 9/2 |

여기서 BV는 $x_1=9/2$, $s_2=9/2$이고 $R_0$에서 가장 큰 음수 계수를 가진 $x_2^+$가 entering variable로 선정되고 ratio test를 진행하면 $R_1 : \frac{9/2}{1/2} = 9$, $R_2 : \frac{9/2}{3/2}=3$ 으로 $R_2$를 피벗 행으로 합니다.

| $z$ | $x_1$ | $x_2^+$ | $x_2^-$ | $s_1$ | $s_2$ | RHS |
|----------|---------|----------|---------|----------|----------|----------|
| 1 | 0 | 0 | 0 | 4/3 | 1/3 | 15 |
| 0 | 1 | 0 | 0 | 2/3 | -1/3 | 3 |
| 0 | 0 | 1 | -1 | -1/3 | 2/3 | 3 |

여기서 BV는 $x_1=3$, $x_2^+=3$이고 가장 최적화 솔루션에 해당합니다. $x_2=x_2^+-x_2^-=3-0=3$, $z=15$, $s_1=s_2=0$ 등 최적해가 만들어집니다.

이러한 방법을 사용하는 실제 사례로는 production smoothing scheduling이 있습니다. 한 회사가 3달 동안의 스케쥴링을 하고자 하고 $(m_1, m_2, m_3)=(200, 150, 400)$의 생산 고정수요를 알고 있으면서 제조비용은 2000달러, 보유비용은 500달러, 생산량을 늘릴 때 4000달러, 줄일 때 3000달러가 소요된다고 합니다. 시작하는 달 이전에 300개의 생산 이후 재고는 없다고 합니다.

결정 변수로는 제품 생산량 $p_t$, 재고 보유량 $i_t$, 생산 증가량 x_t^+, 생산 감소량 x_t^-로 정하고 목적 함수 min $z=2000*(p_1+p_2+p_3)+500*(i_1+i_2+i_3)+4000*(x_1^++x_2^++x_3^+)+3000*(x_1^-+x_2^-+x_3^-)$ 이고 제약 조건으로는 $i_1=0+p_1-200$, $i_2=i_1+p_2-150$, $i_3=i_2+p_3-400$, $p_1-300=x_1^+-x_1^-$, $p_2-p_1=x_2^+-x_2^-$, $p_3-p_2=x_3^+-x_3^-$와 같이 작성할 수 있습니다.

---

### goal programming

goal programming(GP)는 각 목표에서 벗어난 편차의 가중 합을 최소화하는 솔루션을 찾습니다. lower and one-sided goal은 그 이하로 떨어지고 싶지 않은 하한선을 정하는 것($\ge$), upper and one-sided goal은 그 이상 올라가고 싶지 않은 상한선을 정하는 것($\le$), two-sided goal은 평등 제약에 해당합니다.

프로젝트 관리자가 3가지 제품에 대해서 labor $(40, 30, 20) \le 100$과 raw material $(2,4,3)=10$, profit $(5,8,4) \ge 30$, penalty $(5, 8^-/12^+, 15)$를 정리하고 생산할 수량을 결정하려고 합니다.

결정 변수를 정의하면 $40x_1+30x_2+20x_3 \le 100$, $2x_1+4x_2+3x_3=10$, $5x_1+8x_2+4x_3 \ge 30$으로 만들고 목표와의 차이를 나타내는 $y_1$, $y_2$, $y_3$을 urs를 고려하여서 $40x_1+30x_2+20x_3-(y_1^+-y_1^-)=100$, $2x_1+4x_2+3x_3-(y_2^+-y_2^-)=10$, $5x_1+8x_2+4x_3-(y_3^+-y_3^-)=30$ 와 같이 표시합니다.

목적 함수가 min $z=5y_1^++(8y_2^-+12y_2^+)+15y_3^-$으로 벌금을 최소화하고 싶어합니다.

이를 simplex method로 표현하면 아래와 같고,

$$
min \\
z-5y_1^+ - 8y_2^- - 12y_2^+ - 15y_3^- - M(a_1 + a_2 + a_3)=0\\
s.t \\
40x_1 + 30x_2 + 20x_3 - y_1^+ + y_1^- + a_1 = 100 \\
2x_1 + 4x_2 + 3x_3 - y_2^+ + y_2^- + a_2= 10 \\
5x_1 + 8x_2 + 4x_3 - y_3^+ + y_3^- + a_3= 30 \\
x_1, x_2, x_3, y_1^+, y_1^-, y_2^+, y_2^-, y_3^+, y_3^- \ge 0
$$

이를 simplex tableau로 만들어 반복적으로 풀이하도록 하겠습니다.

| $z$ | $x_1$ | $x_2$ | $x_3$ | $y_1^+$ | $y_1^-$ | $y_2^+$ | $y_2^-$ | $y_3^+$ | $y_3^-$ | $a_1$ | $a_2$ | $a_3$ | RHS |
|---|---|---|---|---|---|---|---|---|---|---|---|---|---|
| 1 | 0 | 0 | 0 | -5 | 0 | -12 | -8 | 0 | -15 | $M$ | $M$ | $M$ | 0 |
| 0 | 40 | 30 | 20 | -1 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 100 |
| 0 | 2 | 4 | 3 | 0 | 0 | -1 | 1 | 0 | 0 | 0 | 1 | 0 | 10 |
| 0 | 5 | 8 | 4 | 0 | 0 | 0 | 0 | -1 | 1 | 0 | 0 | 1 | 30 |

__Iteration 1__
위 테이블에서 $M$과 같은 인공 변수를 삭제하기 위해 $R_1, R_2, R_3$에 $M$을 곱하여 소거,

| $z$ | $x_1$ | $x_2$ | $x_3$ | $y_1^+$ | $y_1^-$ | $y_2^+$ | $y_2^-$ | $y_3^+$ | $y_3^-$ | $a_1$ | $a_2$ | $a_3$ | RHS |
|---|---|---|---|---|---|---|---|---|---|---|---|---|---|
| 1 | $-47M$ | $-42M$ | $-27M$ | $-5+M$ | $-M$ | $-12+M$ | $-8-M$ | $M$ | $-15+M$ | 0 | 0 | 0 | $-140M$ |
| 0 | 40 | 30 | 20 | -1 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 100 |
| 0 | 2 | 4 | 3 | 0 | 0 | -1 | 1 | 0 | 0 | 0 | 1 | 0 | 10 |
| 0 | 5 | 8 | 4 | 0 | 0 | 0 | 0 | -1 | 1 | 0 | 0 | 1 | 30 |

__Iteration 2__
- Entering Variable: $x_1$
- pivot row: $R_1$

| $z$ | $x_1$ | $x_2$ | $x_3$ | $y_1^+$ | $y_1^-$ | $y_2^+$ | $y_2^-$ | $y_3^+$ | $y_3^-$ | $a_1$ | $a_2$ | $a_3$ | RHS |
|---|---|---|---|---|---|---|---|---|---|---|---|---|---|
| 1 | 0 | $-27M/4$ | $-7M/2$ | $-5-7M/40$ | $7M/40$ | $-12+M$ | $-8-M$ | $M$ | $-15+M$ | $47M/40$ | 0 | 0 | $-45M/2$ |
| 0 | 1 | 3/4 | 1/2 | -1/40 | 1/40 | 0 | 0 | 0 | 0 | 1/40 | 0 | 0 | 5/2 |
| 0 | 0 | 5/2 | 2 | 1/20 | -1/20 | -1 | 1 | 0 | 0 | -1/20 | 1 | 0 | 5 |
| 0 | 0 | 17/4 | 3/2 | 1/8 | -1/8 | 0 | 0 | -1 | 1 | -1/8 | 0 | 1 | 35/2 |

__Iteration 3__
- Entering Variable: $x_2$
- pivot row: $R_2$

| $z$ | $x_1$ | $x_2$ | $x_3$ | $y_1^+$ | $y_1^-$ | $y_2^+$ | $y_2^-$ | $y_3^+$ | $y_3^-$ | $a_1$ | $a_2$ | $a_3$ | RHS |
|---|---|---|---|---|---|---|---|---|---|---|---|---|---|
| 1 | 0 | 0 | $19M/10$ | $-5-1M/25$ | $1M/25$ | $-12-7/10M$ | $-8+7/M$ | $M$ | $-15+M$ | $26M/25$ | 0 | 0 | $-9M$ |
| 0 | 1 | 0 | -1/10 | -1/25 | 1/25 | 3/10 | -3/10 | 0 | 0 | 1/25 | -3/10 | 0 | 1 |
| 0 | 0 | 1 | 4/5 | 1/50 | -1/50 | -2/5 | 2/5 | 0 | 0 | -1/50 | 2/5 | 0 | 2 |
| 0 | 0 | 0 | -1/5 | 1/25 | -1/25 | 17/10 | -17/10 | -1 | 1 | -1/25 | -17/10 | 1 | 9 |

__Iteration 4__
- Entering Variable: $y_2^+$
- pivot row: $R_1$

| $z$ | $x_1$ | $x_2$ | $x_3$ | $y_1^+$ | $y_1^-$ | $y_2^+$ | $y_2^-$ | $y_3^+$ | $y_3^-$ | $a_1$ | $a_2$ | $a_3$ | RHS |
|---|---|---|---|---|---|---|---|---|---|---|---|---|---|
| 1 | $40+7M/3$ | 0 | $53M/30−2/5$ | $−33/25−2M/15$ | $8/25+2M/15$ | $0$ | $−20$ | $M$ | $-15+M$ | $26M/25−(M/25×10/3×7M/10)$ | $12+7M/10$ | 0 | $40−20M/3$ |
| 0 | 10/3 | 0 | −1/3 | −2/15 | 2/15 | 1 | -1 | 0 | 0 | 2/15 | −1 | 0 | 10/3 |
| 0 | 4/3 | 1 | 2/3 | 7/150 | −7/150 | 0 | 0 | 0 | 0 | −7/150 | 0 | 0 | 10/3 |
| 0 | −17/3 | 0 | 11/30 | 22/75 | -22/75 | 0 | 0 | -1 | 1 | −22/75 | 0 | 1 | 10/3 |

위 과정을 반복하면 최적해에 도달하게 됩니다. 최종 tableau의 결과는 아래와 같습니다.

$x_1 = 0, x_2 = 3.33, x_3 = 0$

$y_1 = y_1^+ - y_1^- = 0 - 0 = 0$ (Labor 목표를 정확히 달성)

$y_2 = y_2^+ - y_2^- = 3.33 - 0 = 3.33$ (Material 목표를 3.33 초과 달성)

$y_3 = y_3^+ - y_3^- = 0 - 3.33 = -3.33$ (Profit 목표에 3.33 미달)

따라서 최소 벌금 비용은 $z^* = 5(0) + (8(0) + 12(3.33)) + 15(3.33) = 90$이 됩니다.

---

### 참고 자료

[원본 경로 #1](https://youtu.be/f3Gz4SGQV9M?si=d5kmJ6Zbfv0kVrou)

[원본 경로 #2](https://youtu.be/0P5OAcXdUec?si=z2FNzcLmNrV69vSW)

[원본 경로 #3](https://youtu.be/Mz__0uBb2-U?si=hCfhdBTkE2OBDzEQ)

[원본 경로 #4](https://youtu.be/Of5Vh4rkNW8?si=KiZlzZXyBD8f7Rjc)

[원본 경로 #5](https://youtu.be/ROkDaBeEiVs?si=fQih218f9gathbNN)

[원본 경로 #6](https://youtu.be/6ESDNnsVg3g?si=suiKplydAOzOMYrO)

[원본 경로 #7](https://youtu.be/D1xYQdnmKvY?si=vyeB5c4LscZliexz)

[원본 경로 #8](https://youtu.be/6RObf2AtenQ?si=QWkWzDsqdZc_Zzx5)



